"use strict";(self.webpackChunkspartacusstore=self.webpackChunkspartacusstore||[]).push([[112],{5112:(Yn,j,u)=>{u.r(j),u.d(j,{AsmModule:()=>Jn});var t=u(4650),l=u(9144),c=u(3617),m=u(4006),bt=u(591),f=u(2654),R=u(6053),yt=u(910),W=u(8514),It=u(8896),Z=u(1086),Zt=u(7274),h=u(4850),wt=u(5154),S=u(2986),T=u(2198),C=u(2994),w=u(1406),Et=u(537),kt=u(13),F=u(5778),U=u(7545),V=u(3749),g=u(5344),Mt=u(950),p=u(6895),X=u(4459),L=u(7221),D=u(7212),d=u(8555),x=u(5024);class ${}let E=(()=>{class n{constructor(e){this.asmAdapter=e}customerSearch(e){return this.asmAdapter.customerSearch(e)}customerLists(){return this.asmAdapter.customerLists()}bindCart(e){return this.asmAdapter.bindCart(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG($))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Rt=new t.OlP("CustomerSearchPageNormalizer"),Ft=new t.OlP("CustomerListsNormalizer");let tt=(()=>{class n{constructor(e,o,s){this.commandService=e,this.asmConnector=o,this.userAccountFacade=s,this.bindCartCommand$=this.commandService.create(r=>this.userAccountFacade.get().pipe((0,h.U)(a=>{if(a?.uid)return a.uid;throw new Error("No identifier for authenticated user found.")}),(0,S.q)(1),(0,w.b)(a=>this.asmConnector.bindCart({cartId:r,customerId:a}))))}bindCart(e){return this.bindCartCommand$.execute(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(c.VDr),t.LFG(E),t.LFG(D.gf))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const O="[Asm] UI Update";class N{constructor(i){this.payload=i,this.type=O}}const b="[asm] Customer search data",y="[asm] Customer list customers search data",J="[Asm] Customer Search",P="[Asm] Customer List Customers Search";class at extends c.kPG.LoaderLoadAction{constructor(i){super(b),this.payload=i,this.type=J}}class ut extends c.kPG.LoaderFailAction{constructor(i){super(b),this.payload=i,this.type="[Asm] Customer Search Fail"}}class lt extends c.kPG.LoaderSuccessAction{constructor(i){super(b),this.payload=i,this.type="[Asm] Customer Search Success"}}class mt extends c.kPG.LoaderResetAction{constructor(){super(b),this.type="[Asm] Customer Search Reset"}}class dt extends c.kPG.LoaderLoadAction{constructor(i){super(y),this.payload=i,this.type=P}}class pt extends c.kPG.LoaderFailAction{constructor(i){super(y),this.payload=i,this.type="[Asm] Customer List Customers Search Fail"}}class _t extends c.kPG.LoaderSuccessAction{constructor(i){super(y),this.payload=i,this.type="[Asm] Customer List Customers Search Success"}}class gt extends c.kPG.LoaderResetAction{constructor(){super(y),this.type="[Asm] Customer List Customers Search Reset"}}const Dt=[(()=>{class n{constructor(e,o){this.actions$=e,this.asmConnector=o,this.customerSearch$=(0,x.GW)(()=>this.actions$.pipe((0,x.l4)(J),(0,h.U)(s=>s.payload),(0,U.w)(s=>this.asmConnector.customerSearch(s).pipe((0,h.U)(r=>new lt(r)),(0,L.K)(r=>(0,Z.of)(new ut((0,c.cxH)(r)))))))),this.customerListCustomersSearch$=(0,x.GW)(()=>this.actions$.pipe((0,x.l4)(P),(0,h.U)(s=>s.payload),(0,U.w)(s=>this.asmConnector.customerSearch(s).pipe((0,h.U)(r=>new _t(r)),(0,L.K)(r=>(0,Z.of)(new pt((0,c.cxH)(r))))))))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(x.eX),t.LFG(E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})()],Ot={collapsed:!1};function Nt(n=Ot,i){return i.type===O?{...n,...i.payload}:n}const ht=new t.OlP("AsmReducers"),Pt={provide:ht,useFactory:function Jt(){return{customerSearchResult:c.kPG.loaderReducer(b),customerListCustomersSearchResult:c.kPG.loaderReducer(y),asmUi:Nt}}},Bt=[function Yt(n){return function(i,e){return"[Auth] Logout Customer Support Agent"===e.type&&(i={...i,customerSearchResult:{}}),n(i,e)}}],k=(0,d.ZF)("asm"),B=(0,d.P1)(k,n=>n.asmUi),Q=(0,d.P1)(k,n=>n.customerSearchResult),ft=(0,d.P1)(Q,n=>c.kPG.loaderValueSelector(n)),Ct=(0,d.P1)(Q,n=>c.kPG.loaderLoadingSelector(n)),M=(0,d.P1)(k,n=>n.customerListCustomersSearchResult),xt=(0,d.P1)(M,n=>c.kPG.loaderValueSelector(n)),At=(0,d.P1)(M,n=>c.kPG.loaderLoadingSelector(n)),vt=(0,d.P1)(M,n=>c.kPG.loaderErrorSelector(n));let St=(()=>{class n{constructor(e,o,s){this.queryService=e,this.asmConnector=o,this.store=s,this.customerListQuery$=this.queryService.create(()=>this.asmConnector.customerLists(),{reloadOn:void 0,resetOn:void 0})}getCustomerLists(){return this.customerListQuery$.get()}getCustomerListsState(){return this.customerListQuery$.getState()}customerListCustomersSearch(e){this.store.dispatch(new dt(e))}getCustomerListCustomersSearchResults(){return this.store.pipe((0,d.Ys)(xt))}getCustomerListCustomersSearchResultsLoading(){return this.store.pipe((0,d.Ys)(At))}customerListCustomersSearchReset(){this.store.dispatch(new gt)}getCustomerListCustomersSearchResultsError(){return this.store.pipe((0,d.Ys)(vt))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(c._7J),t.LFG(E),t.LFG(d.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const Qt=[St,{provide:g.AH,useExisting:St},tt,{provide:g.AE,useExisting:tt}];let Gt=(()=>{class n{constructor(e,o,s){this.statePersistenceService=e,this.store=o,this.authStorageService=s,this.subscription=new f.w,this.key="asm"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.getAsmState(),onRead:e=>this.onRead(e)}))}getAsmState(){return(0,R.aj)([this.store.pipe((0,T.h)(e=>!!e.asm),(0,d.Ys)(B)),(0,Z.of)(this.authStorageService.getEmulatedUserToken()),this.authStorageService.getTokenTarget()]).pipe((0,h.U)(([e,o,s])=>{let r=o;return r&&(r={...o},delete r.refresh_token),{ui:e,emulatedUserToken:r,tokenTarget:s}}))}onRead(e){e&&(e.ui&&this.store.dispatch(new N(e.ui)),e.emulatedUserToken&&this.authStorageService.setEmulatedUserToken(e.emulatedUserToken),e.tokenTarget&&this.authStorageService.setTokenTarget(e.tokenTarget))}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(c.WBb),t.LFG(d.yh),t.LFG(g.JW))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[Pt],imports:[p.ez,c.vUS,d.Aw.forFeature("asm",ht,{metaReducers:Bt}),x.sQ.forFeature(Dt)]}),n})();function qt(n){return()=>n.initSync()}let zt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[E,{provide:c.z4I,useFactory:qt,deps:[Gt],multi:!0},...Qt],imports:[p.ez,Ht]}),n})(),G=(()=>{class n{constructor(e){this.store=e}customerSearch(e){this.store.dispatch(new at(e))}customerSearchReset(){this.store.dispatch(new mt)}getCustomerSearchResults(){return this.store.pipe((0,d.Ys)(ft))}getCustomerSearchResultsLoading(){return this.store.pipe((0,d.Ys)(Ct))}updateAsmUiState(e){this.store.dispatch(new N(e))}getAsmUiState(){return this.store.pipe((0,d.Ys)(B))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(d.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kt=["bindToCart"];function jt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onSubmit())}),t.TgZ(1,"label"),t._UZ(2,"input",3),t.ALo(3,"cxTranslate"),t.ALo(4,"cxTranslate"),t._UZ(5,"cx-form-errors",4),t.qZA(),t.TgZ(6,"label"),t._UZ(7,"input",5),t.ALo(8,"cxTranslate"),t.ALo(9,"cxTranslate"),t._UZ(10,"cx-form-errors",4),t.qZA(),t.TgZ(11,"button",6),t._uU(12),t.ALo(13,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.csAgentLoginForm),t.xp6(2),t.s9C("placeholder",t.lcZ(3,8,"asm.loginForm.userId.label")),t.uIk("aria-label",t.lcZ(4,10,"asm.loginForm.userId.label")),t.xp6(3),t.Q6J("control",e.csAgentLoginForm.get("userId")),t.xp6(2),t.s9C("placeholder",t.lcZ(8,12,"asm.loginForm.password.label")),t.uIk("aria-label",t.lcZ(9,14,"asm.loginForm.password.label")),t.xp6(3),t.Q6J("control",e.csAgentLoginForm.get("password")),t.xp6(2),t.hij(" ",t.lcZ(13,16,"asm.loginForm.submit")," ")}}function Wt(n,i){1&n&&(t._UZ(0,"cx-dot-spinner",7),t.ALo(1,"cxTranslate")),2&n&&t.uIk("aria-label",t.lcZ(1,1,"common.loading"))}const Vt=["resultList"],Xt=["searchTerm"],$t=["searchResultItem"];function te(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",10,11),t.NdJ("keydown.arrowup",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusPreviousChild(s))})("keydown.arrowdown",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusNextChild(s))})("keydown.arrowright",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.arrowleft",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.enter",function(s){const a=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.selectCustomerFromList(s,a))})("keydown.escape",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.closeResults(s))})("keydown.home",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.end",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("click",function(s){const a=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.selectCustomerFromList(s,a))}),t.TgZ(2,"span",12),t._uU(3),t.qZA(),t.TgZ(4,"span",13),t._uU(5),t.qZA()()}if(2&n){const e=i.$implicit,o=i.index,s=t.oxw(2);t.ekj("active",s.activeFocusedButtonIndex===o),t.Q6J("tabindex",s.activeFocusedButtonIndex===o?0:-1),t.uIk("aria-selected",s.activeFocusedButtonIndex===o),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.uid)}}function ee(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",14,11),t.NdJ("click",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.closeResults(s))})("keydown.enter",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.closeResults(s))})("keydown.escape",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.closeResults(s))})("keydown.arrowright",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.arrowleft",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.home",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))})("keydown.end",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.focusInputText(s))}),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA()}if(2&n){const e=t.oxw(2);t.ekj("active",0===e.activeFocusedButtonIndex),t.uIk("aria-selected",0===e.activeFocusedButtonIndex),t.xp6(2),t.hij(" ",t.lcZ(3,4,"asm.customerSearch.noMatch")," ")}}function ne(n,i){if(1&n&&(t.TgZ(0,"div",6,7),t.YNc(2,te,6,6,"button",8),t.YNc(3,ee,4,6,"button",9),t.ALo(4,"async"),t.qZA()),2&n){const e=i.ngIf,o=t.oxw(),s=t.MAs(3);t.xp6(2),t.Q6J("ngForOf",e.entries),t.xp6(1),t.Q6J("ngIf",!t.lcZ(4,2,o.searchResultsLoading$)&&s.value.length>=3&&!!e.entries&&e.entries.length<=0)}}function oe(n,i){1&n&&(t.TgZ(0,"div",6),t._UZ(1,"cx-dot-spinner",15),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.uIk("aria-label",t.lcZ(2,1,"common.loading")))}function se(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"label",2),t._uU(3),t.qZA(),t.TgZ(4,"label",3),t._uU(5),t.qZA()(),t._UZ(6,"cx-asm-bind-cart"),t.TgZ(7,"button",4),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.logoutCustomer())}),t._uU(8),t.ALo(9,"cxTranslate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(3),t.Oqu(null==e.customer?null:e.customer.name),t.xp6(2),t.Oqu(null==e.customer?null:e.customer.uid),t.xp6(3),t.hij(" ",t.lcZ(9,3,"asm.endSession")," ")}}function ie(n,i){1&n&&(t.TgZ(0,"span",3),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.toggleUi.collapse")," "))}function re(n,i){1&n&&(t.TgZ(0,"span",3),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.toggleUi.expand")," "))}const ce=["customerListLink"];function ae(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",9)(1,"a",10,11),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.showCustomList())}),t._UZ(3,"cx-icon",12),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("type",e.iconTypes.USER_FRIENDS),t.xp6(2),t.Oqu(t.lcZ(6,2,"asm.customers"))}}function ue(n,i){1&n&&t._UZ(0,"cx-asm-session-timer")}function le(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.hideUi())}),t.ALo(1,"cxTranslate"),t.qZA()}2&n&&t.s9C("title",t.lcZ(1,1,"asm.hideUi"))}function me(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.logout())}),t.ALo(1,"cxTranslate"),t.qZA()}2&n&&t.s9C("title",t.lcZ(1,1,"asm.logout"))}function de(n,i){1&n&&t._UZ(0,"cx-customer-emulation")}function pe(n,i){if(1&n&&(t.ynx(0),t.YNc(1,de,1,0,"cx-customer-emulation",6),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e)}}function _e(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"cx-customer-selection",19),t.NdJ("submitEvent",function(s){t.CHM(e);const r=t.oxw(4);return t.KtG(r.startCustomerEmulationSession(s))}),t.qZA()}}function ge(n,i){if(1&n&&t.YNc(0,_e,1,0,"cx-customer-selection",18),2&n){const e=t.oxw(2).ngIf;t.Q6J("ngIf",e)}}function he(n,i){if(1&n&&(t.ynx(0),t.YNc(1,pe,2,1,"ng-container",15),t.ALo(2,"async"),t.YNc(3,ge,1,1,"ng-template",null,17,t.W1O),t.BQk()),2&n){const e=t.MAs(4),o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,o.customer$))("ngIfElse",e)}}function fe(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"cx-csagent-login-form",21),t.NdJ("submitEvent",function(s){t.CHM(e);const r=t.oxw(3);return t.KtG(r.loginCustomerSupportAgent(s))}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("csAgentTokenLoading",t.lcZ(1,1,e.csAgentTokenLoading$))}}function Ce(n,i){if(1&n&&t.YNc(0,fe,2,3,"cx-csagent-login-form",20),2&n){const e=t.oxw().ngIf;t.Q6J("ngIf",e)}}function xe(n,i){if(1&n&&(t.ynx(0),t.YNc(1,he,5,4,"ng-container",15),t.ALo(2,"async"),t.YNc(3,Ce,1,1,"ng-template",null,16,t.W1O),t.BQk()),2&n){const e=t.MAs(4),o=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,o.customerSupportAgentLoggedIn$))("ngIfElse",e)}}function Ae(n,i){}function ve(n,i){1&n&&t.YNc(0,Ae,0,0,"ng-template")}function Se(n,i){}function Te(n,i){1&n&&t.YNc(0,Se,0,0,"ng-template")}function Le(n,i){}function be(n,i){1&n&&t.YNc(0,Le,0,0,"ng-template")}function ye(n,i){}function Ie(n,i){1&n&&t.YNc(0,ye,0,0,"ng-template")}const Ze=function(n){return{customerListsPage:n}};function we(n,i){if(1&n&&(t.TgZ(0,"div",18),t.ALo(1,"async"),t.YNc(2,Te,1,0,null,19),t.TgZ(3,"div",20),t.ALo(4,"async"),t.YNc(5,be,1,0,null,5),t.YNc(6,Ie,1,0,null,5),t.qZA()()),2&n){const e=i.ngIf,o=t.oxw(),s=t.MAs(33),r=t.MAs(29),a=t.MAs(31);t.ekj("tablet-mobile",t.lcZ(1,8,o.breakpoint$)!==o.BREAKPOINT.md),t.xp6(2),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(12,Ze,e)),t.xp6(1),t.ekj("mobile",t.lcZ(4,10,o.breakpoint$)===o.BREAKPOINT.xs),t.xp6(2),t.Q6J("ngTemplateOutlet",r),t.xp6(1),t.Q6J("ngTemplateOutlet",a)}}function Ee(n,i){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.noLists")," "))}function ke(n,i){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.listsError")," "))}function Me(n,i){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"generalErrors.pageFailure")," "))}function Re(n,i){1&n&&t._UZ(0,"cx-spinner")}function Fe(n,i){1&n&&(t.TgZ(0,"th",29)(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"asm.customerList.tableHeader.customer")," "))}function Ue(n,i){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.headerLocalizationKey))}}function De(n,i){if(1&n&&(t.TgZ(0,"th",30),t.YNc(1,Ue,3,3,"span",11),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",e.headerLocalizationKey)}}function Oe(n,i){if(1&n&&(t.TgZ(0,"thead")(1,"tr",26),t.YNc(2,Fe,4,3,"th",27),t.YNc(3,De,2,1,"th",28),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",null==e.customerListConfig?null:e.customerListConfig.showAvatar),t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function Ne(n,i){if(1&n&&(t.TgZ(0,"td",33)(1,"div",34),t._uU(2),t.qZA()()),2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",o.getBadgeText(e)," ")}}function Je(n,i){}function Pe(n,i){1&n&&t.YNc(0,Je,0,0,"ng-template")}const Ye=function(n,i){return{customerEntry:n,column:i,showHeader:!1}};function Be(n,i){if(1&n&&(t.TgZ(0,"td",36),t.YNc(1,Pe,1,0,null,19),t.qZA()),2&n){const e=i.$implicit,o=t.oxw(2).$implicit;t.oxw(2);const s=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.WLB(2,Ye,o,e))}}function Qe(n,i){if(1&n&&(t.ynx(0),t.YNc(1,Be,2,5,"td",35),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function Ge(n,i){}function He(n,i){1&n&&t.YNc(0,Ge,0,0,"ng-template")}const H=function(n,i){return{customerEntry:n,column:i,showHeader:!0}};function qe(n,i){if(1&n&&(t.ynx(0),t.YNc(1,He,1,0,null,19),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw(2).$implicit;t.oxw(2);const s=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.WLB(2,H,o,e))}}function ze(n,i){if(1&n&&(t.ynx(0),t.YNc(1,qe,2,5,"ng-container",11),t.BQk()),2&n){const e=i.even;t.xp6(1),t.Q6J("ngIf",e)}}function Ke(n,i){}function je(n,i){1&n&&t.YNc(0,Ke,0,0,"ng-template")}function We(n,i){if(1&n&&(t.ynx(0),t.YNc(1,je,1,0,null,19),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw(2).$implicit;t.oxw(2);const s=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.WLB(2,H,o,e))}}function Ve(n,i){if(1&n&&(t.ynx(0),t.YNc(1,We,2,5,"ng-container",11),t.BQk()),2&n){const e=i.odd;t.xp6(1),t.Q6J("ngIf",e)}}function Xe(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"td",37),t.YNc(2,ze,2,1,"ng-container",38),t.qZA(),t.TgZ(3,"td",37),t.YNc(4,Ve,2,1,"ng-container",38),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns),t.xp6(2),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function $e(n,i){}function tn(n,i){1&n&&t.YNc(0,$e,0,0,"ng-template")}function en(n,i){if(1&n&&(t.ynx(0),t.YNc(1,tn,1,0,null,19),t.BQk()),2&n){const e=i.$implicit,o=t.oxw(2).$implicit;t.oxw(2);const s=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.WLB(2,H,o,e))}}function nn(n,i){if(1&n&&(t.TgZ(0,"td",37),t.YNc(1,en,2,5,"ng-container",38),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function on(n,i){if(1&n&&(t.TgZ(0,"tr",26),t.YNc(1,Ne,3,1,"td",31),t.YNc(2,Qe,2,1,"ng-container",11),t.ALo(3,"async"),t.YNc(4,Xe,5,2,"ng-container",11),t.ALo(5,"async"),t.YNc(6,nn,2,1,"td",32),t.ALo(7,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.customerListConfig?null:e.customerListConfig.showAvatar),t.xp6(1),t.Q6J("ngIf",t.lcZ(3,4,e.breakpoint$)===e.BREAKPOINT.md),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,6,e.breakpoint$)===e.BREAKPOINT.sm),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,8,e.breakpoint$)===e.BREAKPOINT.xs)}}function sn(n,i){1&n&&(t.TgZ(0,"div",39),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.noCustomers")," "))}function rn(n,i){if(1&n&&(t.TgZ(0,"div")(1,"table",22)(2,"caption",23),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA(),t.YNc(5,Oe,4,2,"thead",11),t.ALo(6,"async"),t.TgZ(7,"tbody"),t.YNc(8,on,8,10,"tr",24),t.qZA()(),t.YNc(9,sn,3,3,"div",25),t.qZA()),2&n){const e=i.ngIf,o=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,4,"asm.customerList.title")," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,6,o.breakpoint$)===o.BREAKPOINT.md),t.xp6(3),t.Q6J("ngForOf",null==e?null:e.entries),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.entries.length))}}function cn(n,i){if(1&n&&(t.TgZ(0,"span",43),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n){const e=t.oxw().column;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.headerLocalizationKey)," ")}}function an(n,i){1&n&&t.GkF(0)}const Tt=function(n,i){return{column:n,customerEntry:i}};function un(n,i){if(1&n&&(t.ynx(0),t.YNc(1,an,1,0,"ng-container",19),t.BQk()),2&n){const e=t.oxw(),o=e.column,s=e.customerEntry;t.oxw();const r=t.MAs(27);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.WLB(2,Tt,o,s))}}function ln(n,i){1&n&&t.GkF(0)}function mn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",44),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(),r=s.customerEntry,a=s.column,_=t.oxw();return t.KtG(_.startColumnAction(r,a.actionType))}),t.ALo(1,"cxTranslate"),t.ALo(2,"cxTranslate"),t.YNc(3,ln,1,0,"ng-container",19),t.qZA()}if(2&n){const e=t.oxw(),o=e.column,s=e.customerEntry;t.oxw();const r=t.MAs(27);let a,_;t.uIk("title",o.icon?t.lcZ(1,4,null!==(a=o.icon.captionLocalizationKey)&&void 0!==a?a:o.headerLocalizationKey):void 0)("aria-label",o.icon?t.lcZ(2,6,null!==(_=o.icon.captionLocalizationKey)&&void 0!==_?_:o.headerLocalizationKey):void 0),t.xp6(3),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.WLB(8,Tt,o,s))}}function dn(n,i){if(1&n&&(t.TgZ(0,"div",40),t.YNc(1,cn,3,3,"span",41),t.YNc(2,un,2,5,"ng-container",11),t.YNc(3,mn,4,11,"button",42),t.qZA()),2&n){const e=i.column,o=i.showHeader;t.xp6(1),t.Q6J("ngIf",o),t.xp6(1),t.Q6J("ngIf",!e.actionType),t.xp6(1),t.Q6J("ngIf",e.actionType)}}function pn(n,i){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(),o=e.column,s=e.customerEntry;t.xp6(1),t.Oqu((null==o.renderer?null:o.renderer(s))||"")}}function _n(n,i){if(1&n&&(t._UZ(0,"cx-icon",46),t.ALo(1,"cxTranslate"),t.ALo(2,"cxTranslate")),2&n){const e=t.oxw().column;let o,s;t.ekj("cx-action-color",e.actionType),t.Q6J("type",e.icon.symbol),t.uIk("title",e.actionType?void 0:t.lcZ(1,5,null!==(o=e.icon.captionLocalizationKey)&&void 0!==o?o:e.headerLocalizationKey))("aria-label",e.actionType?void 0:t.lcZ(2,7,null!==(s=e.icon.captionLocalizationKey)&&void 0!==s?s:e.headerLocalizationKey))}}function gn(n,i){if(1&n&&(t.YNc(0,pn,2,1,"span",11),t.YNc(1,_n,3,9,"cx-icon",45)),2&n){const e=i.column;t.Q6J("ngIf",!e.icon),t.xp6(1),t.Q6J("ngIf",e.icon)}}const Lt=function(n){return{ariaLabel:n,ariaControls:"asm-cusomer-list-table"}};function hn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"label")(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"cx-sorting",47),t.NdJ("sortListEvent",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.changeSortCode(s))}),t.ALo(5,"async"),t.ALo(6,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,6,"asm.customerList.tableSort.sortBy")),t.xp6(2),t.s9C("placeholder",t.lcZ(6,10,"asm.customerList.tableSort.sortBy")),t.Q6J("sortOptions",e.sorts)("sortLabels",t.lcZ(5,8,e.getSortLabels()))("selectedOption",e.sortCode)("cxNgSelectA11y",t.VKq(12,Lt,e.sortCode))}}function fn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.goToPreviousPage())}),t._UZ(1,"cx-icon",52),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",0===e.currentPage||!e.loaded),t.xp6(1),t.Q6J("type",e.iconTypes.CARET_LEFT),t.xp6(2),t.Oqu(t.lcZ(4,3,"asm.customerList.page.previous"))}}function Cn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.goToNextPage())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t._UZ(4,"cx-icon",54),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",e.currentPage===e.maxPage||!e.loaded),t.xp6(2),t.Oqu(t.lcZ(3,3,"asm.customerList.page.next")),t.xp6(2),t.Q6J("type",e.iconTypes.CARET_RIGHT)}}const xn=function(n){return{count:n}};function An(n,i){if(1&n&&(t.TgZ(0,"div",48)(1,"div"),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.YNc(4,fn,5,5,"button",49),t.YNc(5,Cn,5,5,"button",50),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.hij(" ",t.xi3(3,3,"asm.customerList.page.page",t.VKq(6,xn,e.currentPage+1))," "),t.xp6(2),t.Q6J("ngIf",e.maxPage>0),t.xp6(1),t.Q6J("ngIf",e.maxPage>0)}}function vn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"label")(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"ng-select",55),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onChangeCustomerGroup())})("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.selectedUserGroupId=s)}),t.qZA()()}if(2&n){const e=i.customerListsPage,o=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,7,"asm.customerList.title")),t.xp6(2),t.Q6J("searchable",!1)("clearable",!1)("tabIndex",0)("ngModel",o.selectedUserGroupId)("items",null==e?null:e.userGroups)("cxNgSelectA11y",t.VKq(9,Lt,o.getGroupName(e,o.selectedUserGroupId)))}}function Sn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",56),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.closeModal("Cross click"))}),t.ALo(1,"cxTranslate"),t.TgZ(2,"span",57),t._UZ(3,"cx-icon",46),t.qZA()()}if(2&n){const e=t.oxw();t.uIk("aria-label",t.lcZ(1,2,"common.close")),t.xp6(3),t.Q6J("type",e.iconTypes.CLOSE)}}var A=(()=>{return(n=A||(A={})).CANCEL="CANCEL",n.REPLACE="REPLACE",A;var n})();let Tn=(()=>{class n{constructor(e){this.launchDialogService=e,this.BIND_CART_ACTION=A,this.focusConfig={trap:!0,block:!0,autofocus:!0,focusOnEscape:!0}}closeModal(e){this.launchDialogService.closeDialog(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.Q3W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-bind-cart-dialog"]],decls:20,vars:19,consts:[[1,"cx-asm-bind-cart-dialog","cx-modal-container","cx-asm-dialog",3,"cxFocus","esc"],[1,"cx-modal-content"],[1,"cx-dialog-header","modal-header"],["id","asm-bind-cart-dialog-title",1,"title","modal-title"],[1,"cx-dialog-body","modal-body"],[1,"cx-dialog-row"],[1,"cx-dialog-item"],[1,"cx-dialog-footer","modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.NdJ("esc",function(){return o.closeModal(o.BIND_CART_ACTION.CANCEL)}),t.TgZ(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4),t.ALo(5,"cxTranslate"),t.qZA()(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6),t._uU(9),t.ALo(10,"cxTranslate"),t.qZA()()(),t.TgZ(11,"div",7)(12,"button",8),t.NdJ("click",function(){return o.closeModal(o.BIND_CART_ACTION.REPLACE)}),t.ALo(13,"cxTranslate"),t._uU(14),t.ALo(15,"cxTranslate"),t.qZA(),t.TgZ(16,"button",9),t.NdJ("click",function(){return o.closeModal(o.BIND_CART_ACTION.CANCEL)}),t.ALo(17,"cxTranslate"),t._uU(18),t.ALo(19,"cxTranslate"),t.qZA()()()()),2&e&&(t.Q6J("cxFocus",o.focusConfig),t.xp6(4),t.hij(" ",t.lcZ(5,7,"asm.bindCart.dialog.title")," "),t.xp6(5),t.hij(" ",t.lcZ(10,9,"asm.bindCart.dialog.body")," "),t.xp6(3),t.uIk("aria-label",t.lcZ(13,11,"asm.bindCart.dialog.actions.replace")),t.xp6(2),t.hij(" ",t.lcZ(15,13,"asm.bindCart.dialog.actions.replace")," "),t.xp6(2),t.uIk("aria-label",t.lcZ(17,15,"common.cancel")),t.xp6(2),t.hij(" ",t.lcZ(19,17,"common.cancel")," "))},dependencies:[l.RRe,c.X$D],encapsulation:2}),n})(),q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-dot-spinner"]],decls:3,vars:0,template:function(e,o){1&e&&t._UZ(0,"div")(1,"div")(2,"div")},encapsulation:2,changeDetection:0}),n})(),Ln=(()=>{class n{constructor(e,o,s,r,a,_){this.globalMessageService=e,this.activeCartFacade=o,this.multiCartFacade=s,this.asmBindCartFacade=r,this.launchDialogService=a,this.savedCartFacade=_,this.activeCartValidator=I=>I.value===this.activeCartId?{activeCartError:!0}:null,this.cartId=new m.NI("",[m.kI.required,m.kI.minLength(1),this.activeCartValidator]),this.loading$=new bt.X(!1),this.valid$=this.cartId.statusChanges.pipe((0,h.U)(I=>"VALID"===I),(0,wt.d)(1)),this.activeCartId="",this.subscription=new f.w}ngOnInit(){this.subscription.add(this.activeCartFacade.getActiveCartId().subscribe(e=>{this.activeCartId=e??"",this.cartId.setValue(this.activeCartId)}))}resetInput(){this.cartId.value||this.cartId.setValue(this.activeCartId)}bindCartToCustomer(){const e=this.cartId.value,o=(0,R.aj)([this.loading$.asObservable(),this.valid$]).pipe((0,S.q)(1),(0,T.h)(([s,r])=>!s&&r),(0,C.b)(()=>this.loading$.next(!0)),(0,w.b)(()=>this.activeCartFacade.getActive().pipe((0,h.U)(s=>s.deliveryItemsQuantity??0),(0,S.q)(1))),(0,w.b)(s=>(0,yt.s)(()=>Boolean(this.activeCartId&&s),this.openDialog(this.activeCartId,e),this.simpleBindCart(e))),(0,Et.x)(()=>this.loading$.next(!1))).subscribe(()=>{this.globalMessageService.add({key:"asm.bindCart.success"},c.xUg.MSG_TYPE_CONFIRMATION)},s=>{this.globalMessageService.add(s.details?.[0].message??"",c.xUg.MSG_TYPE_ERROR)});this.subscription.add(o)}clearText(){this.cartId.setValue("")}ngOnDestroy(){this.subscription.unsubscribe()}simpleBindCart(e){return(0,W.P)(()=>this.asmBindCartFacade.bindCart(e)).pipe((0,C.b)(()=>this.multiCartFacade.reloadCart(c.gSv)))}openDialog(e,o){return(0,W.P)(()=>(this.launchDialogService.openDialogAndSubscribe("ASM_BIND_CART",this.bindToCartElemRef),this.launchDialogService.dialogClose.pipe((0,T.h)(s=>Boolean(s)),(0,S.q)(1)))).pipe((0,T.h)(s=>Boolean(s)),(0,w.b)(s=>this.selectBindAction(e,o,s)))}selectBindAction(e,o,s){return s===A.REPLACE?this.replaceCart(e,o):It.E}replaceCart(e,o){return this.simpleBindCart(o).pipe((0,C.b)(()=>{this.savedCartFacade.saveCart({cartId:e,saveCartName:e,saveCartDescription:"-"})}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.IWp),t.Y36(V.bu),t.Y36(V.WT),t.Y36(g.AE),t.Y36(l.Q3W),t.Y36(Mt.aD))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-bind-cart"]],viewQuery:function(e,o){if(1&e&&t.Gf(Kt,5),2&e){let s;t.iGM(s=t.CRH())&&(o.bindToCartElemRef=s.first)}},decls:25,vars:42,consts:[[3,"submit"],["for","cartNumber"],["role","search",1,"cx-asm-assignCart",3,"click"],["autocomplete","off","formcontrolname","cartNumber",3,"formControl","keydown.enter","blur"],["cartIdElement",""],[1,"cx-asm-reset",3,"click"],[1,"cx-icon","fas","fa-times-circle"],["type","submit",1,"cx-asm-bindCartToCustomer",3,"disabled"],["bindToCart",""]],template:function(e,o){if(1&e){const s=t.EpF();t.TgZ(0,"form",0),t.NdJ("submit",function(){return o.bindCartToCustomer()}),t.TgZ(1,"label",1),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"div",2),t.NdJ("click",function(){t.CHM(s);const a=t.MAs(8);return t.KtG(a.focus())}),t.ALo(5,"async"),t.ALo(6,"cxTranslate"),t.TgZ(7,"input",3,4),t.NdJ("keydown.enter",function(){return o.bindCartToCustomer()})("blur",function(){return o.resetInput()}),t.ALo(9,"cxTranslate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return o.clearText()}),t.ALo(11,"cxTranslate"),t._UZ(12,"cx-icon",6),t.qZA()(),t.TgZ(13,"button",7,8),t.ALo(15,"async"),t.ALo(16,"async"),t.ALo(17,"async"),t.TgZ(18,"span"),t.ALo(19,"async"),t._uU(20),t.ALo(21,"cxTranslate"),t.qZA(),t._UZ(22,"cx-dot-spinner"),t.ALo(23,"async"),t.ALo(24,"cxTranslate"),t.qZA()()}2&e&&(t.xp6(2),t.hij("",t.lcZ(3,18,"asm.bindCart.cartNumber")," "),t.xp6(2),t.ekj("active",t.lcZ(5,20,o.valid$)),t.uIk("aria-label",t.lcZ(6,22,"asm.bindCart.assignCartId")),t.xp6(3),t.Q6J("formControl",o.cartId),t.uIk("aria-label",t.lcZ(9,24,"asm.bindCart.enterCartId")),t.xp6(3),t.ekj("visible",(null==o.cartId.value?null:o.cartId.value.length)>0),t.uIk("aria-label",t.lcZ(11,26,"asm.bindCart.resetCartId")),t.xp6(3),t.ekj("cx-asm-active",t.lcZ(15,28,o.valid$))("cx-bind-loading",t.lcZ(16,30,o.loading$)),t.Q6J("disabled",!t.lcZ(17,32,o.valid$)),t.xp6(5),t.uIk("aria-hidden",t.lcZ(19,34,o.loading$)),t.xp6(2),t.hij(" ",t.lcZ(21,36,"asm.bindCart.bindCartToCustomer")," "),t.xp6(2),t.uIk("aria-hidden",!t.lcZ(23,38,o.loading$))("aria-label",t.lcZ(24,40,"common.loading")))},dependencies:[m._Y,m.Fj,m.JJ,m.JL,m.oH,l.oJW,m.F,q,p.Ov,c.X$D],encapsulation:2,changeDetection:0}),n})(),z=(()=>{class n{constructor(e,o,s){this.authService=e,this.csAgentAuthService=o,this.winRef=s}logoutCustomerSupportAgentAndCustomer(){this.csAgentAuthService.logoutCustomerSupportAgent()}logoutCustomer(){this.authService.logout()}isCustomerEmulationSessionInProgress(){return this.csAgentAuthService.isCustomerEmulated()}unload(){this.winRef.localStorage&&this.winRef.localStorage.removeItem(g.AJ)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(c.e80),t.LFG(g.FA),t.LFG(c.X9E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bn=(()=>{class n{constructor(e){this.fb=e,this.csAgentTokenLoading=!1,this.submitEvent=new t.vpe}ngOnInit(){this.csAgentLoginForm=this.fb.group({userId:["",[m.kI.required]],password:["",[m.kI.required]]})}onSubmit(){this.csAgentLoginForm.valid?this.submitEvent.emit({userId:this.csAgentLoginForm.get("userId")?.value,password:this.csAgentLoginForm.get("password")?.value}):this.csAgentLoginForm.markAllAsTouched()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.QS))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-csagent-login-form"]],inputs:{csAgentTokenLoading:"csAgentTokenLoading"},outputs:{submitEvent:"submitEvent"},decls:2,vars:2,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],["aria-hidden","false",4,"ngIf"],[3,"formGroup","ngSubmit"],["required","true","type","text","formControlName","userId",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",3,"placeholder"],["type","submit"],["aria-hidden","false"]],template:function(e,o){1&e&&(t.YNc(0,jt,14,18,"form",0),t.YNc(1,Wt,2,3,"cx-dot-spinner",1)),2&e&&(t.Q6J("ngIf",!o.csAgentTokenLoading),t.xp6(1),t.Q6J("ngIf",o.csAgentTokenLoading))},dependencies:[p.O5,m._Y,m.Fj,m.JJ,m.JL,m.Q7,m.sg,m.u,l.Ahv,l.X84,q,c.X$D],encapsulation:2}),n})(),yn=(()=>{class n{constructor(e,o,s,r){this.fb=e,this.asmService=o,this.config=s,this.directionService=r,this.subscription=new f.w,this.submitEvent=new t.vpe,this.activeFocusedButtonIndex=-1}ngOnInit(){this.customerSelectionForm=this.fb.group({searchTerm:["",m.kI.required]}),this.asmService.customerSearchReset(),this.searchResultsLoading$=this.asmService.getCustomerSearchResultsLoading(),this.searchResults=this.asmService.getCustomerSearchResults(),this.subscription.add(this.customerSelectionForm.controls.searchTerm.valueChanges.pipe((0,kt.b)(300)).subscribe(e=>{this.handleSearchTerm(e)}))}handleSearchTerm(e){this.selectedCustomer&&e!==this.selectedCustomer.name&&(this.selectedCustomer=void 0),!Boolean(this.selectedCustomer)&&(this.asmService.customerSearchReset(),this.activeFocusedButtonIndex=-1,e.trim().length>=3&&this.asmService.customerSearch({query:e,pageSize:this.config.asm?.customerSearch?.maxResults}))}selectCustomerFromList(e,o){this.selectedCustomer=o,this.customerSelectionForm.controls.searchTerm.setValue(this.selectedCustomer.name),this.asmService.customerSearchReset(),this.searchTerm.nativeElement.focus(),e.preventDefault(),e.stopPropagation()}onSubmit(){this.customerSelectionForm.valid&&this.selectedCustomer?this.submitEvent.emit({customerId:this.selectedCustomer.customerId}):this.customerSelectionForm.markAllAsTouched()}onDocumentClick(e){if(Boolean(this.resultList)){if(this.resultList.nativeElement.contains(e.target)||this.searchTerm.nativeElement.contains(e.target))return;this.asmService.customerSearchReset()}}closeResults(e){this.asmService.customerSearchReset(),this.searchTerm.nativeElement.focus(),e.preventDefault(),e.stopPropagation()}ngOnDestroy(){this.subscription.unsubscribe(),this.asmService.customerSearchReset()}focusFirstItem(e){e.preventDefault(),this.activeFocusedButtonIndex=0,this.updateItemIndex(this.activeFocusedButtonIndex)}setSelectionEnd(e){if(e.preventDefault(),this.searchTerm.nativeElement.value?.length){const o=this.searchTerm.nativeElement.value.length;this.searchTerm.nativeElement.selectionStart=o,this.searchTerm.nativeElement.selectionEnd=o}}focusPreviousChild(e){e.preventDefault(),this.activeFocusedButtonIndex--,this.activeFocusedButtonIndex<0&&(this.activeFocusedButtonIndex=this.searchResultItems.length-1),this.updateItemIndex(this.activeFocusedButtonIndex)}focusNextChild(e){e.preventDefault(),this.activeFocusedButtonIndex++,this.activeFocusedButtonIndex>this.searchResultItems.length-1&&(this.activeFocusedButtonIndex=0),this.updateItemIndex(this.activeFocusedButtonIndex)}focusInputText(e){if(e.preventDefault(),this.activeFocusedButtonIndex=-1,this.searchTerm.nativeElement.focus(),this.searchTerm.nativeElement.value?.length){let o=this.searchTerm.nativeElement.selectionEnd;const s=this.searchTerm.nativeElement.value.length;this.isBackNavigation(e)?o=o<=0?0:o-1:this.isForwardsNavigation(e)?o=o>=s?s:o+1:"Home"===e.code?o=0:"End"===e.code&&(o=s),this.searchTerm.nativeElement.selectionStart=o,this.searchTerm.nativeElement.selectionEnd=o}}updateItemIndex(e){this.searchResultItems.toArray()?.[e]?.nativeElement.focus()}isForwardsNavigation(e){return"ArrowRight"===e.code&&this.isLTRDirection()||"ArrowLeft"===e.code&&this.isRTLDirection()}isBackNavigation(e){return"ArrowLeft"===e.code&&this.isLTRDirection()||"ArrowRight"===e.code&&this.isRTLDirection()}isLTRDirection(){return this.directionService.getDirection()===l.uEG.LTR}isRTLDirection(){return this.directionService.getDirection()===l.uEG.RTL}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.QS),t.Y36(G),t.Y36(g.hc),t.Y36(l.Lh6))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-selection"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Vt,5),t.Gf(Xt,5),t.Gf($t,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.resultList=s.first),t.iGM(s=t.CRH())&&(o.searchTerm=s.first),t.iGM(s=t.CRH())&&(o.searchResultItems=s)}},hostBindings:function(e,o){1&e&&t.NdJ("click",function(r){return o.onDocumentClick(r)},!1,t.evT)},outputs:{submitEvent:"submitEvent"},decls:14,vars:19,consts:[[3,"formGroup","ngSubmit"],["required","true","type","text","formControlName","searchTerm",3,"placeholder","keydown.arrowdown","keydown.end"],["searchTerm",""],[3,"control"],["type","submit"],["class","asm-results",4,"ngIf"],[1,"asm-results"],["resultList",""],[3,"tabindex","active","keydown.arrowup","keydown.arrowdown","keydown.arrowright","keydown.arrowleft","keydown.enter","keydown.escape","keydown.home","keydown.end","click",4,"ngFor","ngForOf"],[3,"active","click","keydown.enter","keydown.escape","keydown.arrowright","keydown.arrowleft","keydown.home","keydown.end",4,"ngIf"],[3,"tabindex","keydown.arrowup","keydown.arrowdown","keydown.arrowright","keydown.arrowleft","keydown.enter","keydown.escape","keydown.home","keydown.end","click"],["searchResultItem",""],[1,"result-name"],[1,"result-id"],[3,"click","keydown.enter","keydown.escape","keydown.arrowright","keydown.arrowleft","keydown.home","keydown.end"],["aria-hidden","false"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"label")(2,"input",1,2),t.NdJ("keydown.arrowdown",function(r){return o.focusFirstItem(r)})("keydown.end",function(r){return o.setSelectionEnd(r)}),t.ALo(4,"cxTranslate"),t.ALo(5,"cxTranslate"),t.qZA(),t._UZ(6,"cx-form-errors",3),t.qZA(),t.TgZ(7,"button",4),t._uU(8),t.ALo(9,"cxTranslate"),t.qZA()(),t.YNc(10,ne,5,4,"div",5),t.ALo(11,"async"),t.YNc(12,oe,3,3,"div",5),t.ALo(13,"async")),2&e&&(t.Q6J("formGroup",o.customerSelectionForm),t.xp6(2),t.s9C("placeholder",t.lcZ(5,11,"asm.customerSearch.searchTerm.label")),t.uIk("aria-label",t.lcZ(4,9,"asm.customerSearch.searchTerm.label")),t.xp6(4),t.Q6J("control",o.customerSelectionForm.get("searchTerm")),t.xp6(1),t.ekj("active",o.selectedCustomer),t.xp6(1),t.hij(" ",t.lcZ(9,13,"asm.customerSearch.submit")," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,15,o.searchResults)),t.xp6(2),t.Q6J("ngIf",t.lcZ(13,17,o.searchResultsLoading$)))},dependencies:[p.sg,p.O5,m._Y,m.Fj,m.JJ,m.JL,m.Q7,m.sg,m.u,l.Ahv,q,p.Ov,c.X$D],encapsulation:2}),n})(),In=(()=>{class n{transform(e){e<0&&(e=0);const o=Math.floor(e/60),s=e%60;let r;return r=o<10?("00"+o).slice(-2):o+"",`${r}:${("00"+s).slice(-2)}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"formatTimer",type:n,pure:!0}),n})(),Zn=(()=>{class n{constructor(e,o,s,r,a){this.config=e,this.asmComponentService=o,this.routingService=s,this.changeDetectorRef=r,this.userIdService=a,this.subscriptions=new f.w,this.maxStartDelayInSeconds=6e4}ngOnInit(){this.timeLeft=this.getTimerStartDelayInSeconds(),this.interval=setInterval(()=>{this.timeLeft>0?this.timeLeft--:(clearInterval(this.interval),this.asmComponentService.logoutCustomerSupportAgentAndCustomer()),this.changeDetectorRef.markForCheck()},1e3),this.resetOnNavigate(),this.resetOnCustomerSessionChange()}resetOnNavigate(){this.subscriptions.add(this.routingService.isNavigating().subscribe(e=>{e&&this.resetTimer()}))}resetOnCustomerSessionChange(){this.subscriptions.add(this.userIdService.getUserId().pipe((0,F.x)()).subscribe(()=>this.resetTimer()))}resetTimer(){this.timeLeft>0&&(this.timeLeft=this.getTimerStartDelayInSeconds())}getTimerStartDelayInSeconds(){return void 0===this.config.asm?.agentSessionTimer?.startingDelayInSeconds?600:this.config.asm.agentSessionTimer.startingDelayInSeconds>this.maxStartDelayInSeconds?this.maxStartDelayInSeconds:this.config.asm.agentSessionTimer.startingDelayInSeconds}ngOnDestroy(){this.subscriptions.unsubscribe(),this.interval&&clearInterval(this.interval)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.hc),t.Y36(z),t.Y36(c.Znh),t.Y36(t.sBO),t.Y36(c.XBV))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-session-timer"]],decls:9,vars:12,consts:[[1,"label"],[1,"time"],[1,"reset",3,"title","click"]],template:function(e,o){1&e&&(t.TgZ(0,"span",0),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA(),t.TgZ(3,"span",1),t._uU(4),t.ALo(5,"formatTimer"),t.ALo(6,"cxTranslate"),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(){return o.resetTimer()}),t.ALo(8,"cxTranslate"),t.qZA()),2&e&&(t.xp6(1),t.hij("",t.lcZ(2,4,"asm.agentSessionTimer.label"),":"),t.xp6(3),t.AsE("",t.lcZ(5,6,o.timeLeft)," ",t.lcZ(6,8,"asm.agentSessionTimer.minutes"),""),t.xp6(3),t.s9C("title",t.lcZ(8,10,"asm.agentSessionTimer.reset")))},dependencies:[c.X$D,In],encapsulation:2}),n})(),wn=(()=>{class n{constructor(e,o){this.asmComponentService=e,this.userAccountFacade=o,this.subscription=new f.w}ngOnInit(){this.subscription.add(this.userAccountFacade.get().subscribe(e=>{e&&(this.customer=e)})),this.isCustomerEmulationSessionInProgress$=this.asmComponentService.isCustomerEmulationSessionInProgress()}logoutCustomer(){this.asmComponentService.logoutCustomer()}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(z),t.Y36(D.gf))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-emulation"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-asm-customerInfo"],[1,"cx-asm-name"],[1,"cx-asm-uid"],["formcontrolname","logoutCustomer",3,"click"]],template:function(e,o){1&e&&(t.YNc(0,se,10,5,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.isCustomerEmulationSessionInProgress$))},dependencies:[p.O5,Ln,p.Ov,c.X$D],encapsulation:2}),n})(),En=(()=>{class n{constructor(e){this.asmService=e,this.subscription=new f.w}ngOnInit(){this.subscription.add(this.asmService.getAsmUiState().subscribe(e=>{this.isCollapsed=void 0!==e.collapsed&&e.collapsed}))}toggleUi(){this.asmService.updateAsmUiState({collapsed:!this.isCollapsed})}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(G))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-toggle-ui"]],decls:4,vars:3,consts:[["tabindex","0","role","button",1,"toggleUi",3,"click"],[3,"ngClass"],["class","label",4,"ngIf"],[1,"label"]],template:function(e,o){1&e&&(t.TgZ(0,"a",0),t.NdJ("click",function(){return o.toggleUi()}),t._UZ(1,"span",1),t.YNc(2,ie,3,3,"span",2),t.YNc(3,re,3,3,"span",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngClass",o.isCollapsed?"expandIcon":"collapseIcon"),t.xp6(1),t.Q6J("ngIf",!o.isCollapsed),t.xp6(1),t.Q6J("ngIf",o.isCollapsed))},dependencies:[p.mk,p.O5,c.X$D],encapsulation:2}),n})(),kn=(()=>{class n{constructor(e,o,s,r,a,_,I,Pn){this.authService=e,this.csAgentAuthService=o,this.asmComponentService=s,this.globalMessageService=r,this.routingService=a,this.asmService=_,this.userAccountFacade=I,this.launchDialogService=Pn,this.iconTypes=l.e1G,this.disabled=!1,this.startingCustomerSession=!1,this.subscription=new f.w}ngOnInit(){this.customerSupportAgentLoggedIn$=this.csAgentAuthService.isCustomerSupportAgentLoggedIn().pipe((0,F.x)(),(0,C.b)(e=>{e||this.closeModal()})),this.csAgentTokenLoading$=this.csAgentAuthService.getCustomerSupportAgentTokenLoading(),this.customer$=this.authService.isUserLoggedIn().pipe((0,U.w)(e=>e?(this.handleCustomerSessionStartRedirection(),this.userAccountFacade.get()):(0,Z.of)(void 0))),this.isCollapsed$=this.asmService.getAsmUiState().pipe((0,h.U)(e=>void 0!==e.collapsed&&e.collapsed)),this.subscription.add(this.launchDialogService.dialogClose.pipe((0,T.h)(e=>Boolean(e))).subscribe(e=>{e.selectedUser&&(this.startCustomerEmulationSession(e.selectedUser),e.actionType===g.JR.ORDER_HISTORY&&this.routingService.go({cxRoute:"orders"}))}))}handleCustomerSessionStartRedirection(){this.asmComponentService.isCustomerEmulationSessionInProgress().pipe((0,S.q)(1)).subscribe(e=>{this.startingCustomerSession&&e&&(this.startingCustomerSession=!1,this.globalMessageService.remove(c.xUg.MSG_TYPE_ERROR),this.routingService.go("/"))})}loginCustomerSupportAgent({userId:e,password:o}){this.csAgentAuthService.authorizeCustomerSupportAgent(e,o)}logout(){this.asmComponentService.logoutCustomerSupportAgentAndCustomer()}startCustomerEmulationSession({customerId:e}){e?(this.csAgentAuthService.startCustomerEmulationSession(e),this.startingCustomerSession=!0):this.globalMessageService.add({key:"asm.error.noCustomerId"},c.xUg.MSG_TYPE_ERROR)}hideUi(){this.disabled=!0,this.asmComponentService.unload()}showCustomList(){this.launchDialogService.openDialogAndSubscribe("ASM_CUSTOMER_LIST",this.element)}closeModal(){this.launchDialogService.closeDialog("logout")}ngOnDestroy(){this.subscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.e80),t.Y36(g.FA),t.Y36(z),t.Y36(c.IWp),t.Y36(c.Znh),t.Y36(G),t.Y36(D.gf),t.Y36(l.Q3W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-main-ui"]],viewQuery:function(e,o){if(1&e&&t.Gf(ce,5),2&e){let s;t.iGM(s=t.CRH())&&(o.element=s.first)}},hostVars:2,hostBindings:function(e,o){2&e&&t.ekj("hidden",o.disabled)},decls:20,vars:23,consts:[[1,"asm-bar"],[1,"asm-bar-branding"],["src","data:image/png;base64,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","width","48","height","24",1,"logo",3,"alt"],[1,"asm-title"],[1,"asm-bar-actions"],["class","cx-asm-customer-list",4,"ngIf"],[4,"ngIf"],["class","close",3,"title","click",4,"ngIf"],["class","logout",3,"title","click",4,"ngIf"],[1,"cx-asm-customer-list"],["tabindex","0","role","button",1,"cx-asm-customer-list-link",3,"click"],["customerListLink",""],[3,"type"],[1,"close",3,"title","click"],[1,"logout",3,"title","click"],[4,"ngIf","ngIfElse"],["showLoginForm",""],["showCustomerSelection",""],[3,"submitEvent",4,"ngIf"],[3,"submitEvent"],[3,"csAgentTokenLoading","submitEvent",4,"ngIf"],[3,"csAgentTokenLoading","submitEvent"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",2),t.ALo(3,"cxTranslate"),t.TgZ(4,"div",3),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA()(),t.TgZ(7,"div",4),t.YNc(8,ae,7,4,"div",5),t.ALo(9,"async"),t._UZ(10,"cx-asm-toggle-ui"),t.YNc(11,ue,1,0,"cx-asm-session-timer",6),t.ALo(12,"async"),t.YNc(13,le,2,3,"button",7),t.ALo(14,"async"),t.ALo(15,"async"),t.YNc(16,me,2,3,"button",8),t.ALo(17,"async"),t.qZA()(),t.YNc(18,xe,5,4,"ng-container",6),t.ALo(19,"async")),2&e&&(t.xp6(2),t.s9C("alt",t.lcZ(3,7,"asm.mainLogoLabel")),t.xp6(3),t.hij(" ",t.lcZ(6,9,"asm.mainTitle")," "),t.xp6(3),t.Q6J("ngIf",t.lcZ(9,11,o.customerSupportAgentLoggedIn$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(12,13,o.customerSupportAgentLoggedIn$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(14,15,o.customerSupportAgentLoggedIn$)&&!t.lcZ(15,17,o.csAgentTokenLoading$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(17,19,o.customerSupportAgentLoggedIn$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(19,21,o.isCollapsed$)))},dependencies:[p.O5,l.oJW,bn,yn,Zn,wn,En,p.Ov,c.X$D],encapsulation:2}),n})();const Mn={launch:{ASM_CUSTOMER_LIST:{inlineRoot:!0,component:(()=>{class n{constructor(e,o,s,r,a){this.launchDialogService=e,this.breakpointService=o,this.asmConfig=s,this.translation=r,this.asmCustomerListFacade=a,this.DEFAULT_PAGE_SIZE=5,this.focusConfig={trap:!0,block:!0,autofocus:"customer-list-selector",focusOnEscape:!0},this.iconTypes=l.e1G,this.BREAKPOINT=l.Bst,this.currentPage=0,this.maxPage=0,this.loaded=!1,this.listsError=!1,this.listsEmpty=!1,this.teardown=new f.w,this.breakpoint$=this.getBreakpoint()}ngOnInit(){this.pageSize=this.asmConfig.asm?.customerList?.pageSize??this.DEFAULT_PAGE_SIZE,this.customerListConfig=this.asmConfig?.asm?.customerList,this.customerListsPage$=this.asmCustomerListFacade.getCustomerListsState().pipe((0,C.b)(e=>this.listsError=!!e.error),(0,h.U)(e=>0===e?.data?.userGroups?.length?void(this.listsEmpty=!0):e.data),(0,F.x)(),(0,C.b)(e=>{this.selectedUserGroupId||(this.selectedUserGroupId=e?.userGroups?.[0]?.uid,this.sorts=null,this.fetchCustomers())}))??Zt.C,this.customerSearchLoading$=this.asmCustomerListFacade.getCustomerListCustomersSearchResultsLoading().pipe((0,C.b)(e=>this.loaded=!e)),this.teardown.add(this.customerSearchLoading$.subscribe()),this.teardown.add(()=>this.asmCustomerListFacade.customerListCustomersSearchReset()),this.customerSearchError$=this.asmCustomerListFacade.getCustomerListCustomersSearchResultsError(),this.customerSearchPage$=this.asmCustomerListFacade.getCustomerListCustomersSearchResults().pipe((0,C.b)(e=>{e?.sorts&&(this.sorts=e.sorts,this.sortCode=e.pagination?.sort),this.maxPage=e?.entries.length<this.pageSize?e.pagination?.currentPage??0:this.currentPage+1}))}ngOnDestroy(){this.teardown.unsubscribe()}fetchCustomers(){if(this.selectedUserGroupId){const e={customerListId:this.selectedUserGroupId,pageSize:this.pageSize,currentPage:this.currentPage};this.sortCode&&(e.sort=this.sortCode),this.asmCustomerListFacade.customerListCustomersSearchReset(),this.asmCustomerListFacade.customerListCustomersSearch(e)}}onChangeCustomerGroup(){this.currentPage=0,this.sorts=null,this.sortCode="",this.fetchCustomers()}getGroupName(e,o){return e?.userGroups?.find(s=>s.uid===o)?.name??""}getBadgeText(e){return(e.firstName?.charAt(0)??"")+(e.lastName?.charAt(0)??"")}startColumnAction(e,o){this.selectedCustomer=e,this.closeModal({actionType:o,selectedUser:e})}changeSortCode(e){this.sortCode=e,this.fetchCustomers()}goToNextPage(){this.currentPage>=this.maxPage?this.currentPage=this.maxPage:this.loaded&&(this.currentPage++,this.fetchCustomers())}goToPreviousPage(){this.currentPage<=0?this.currentPage=0:this.loaded&&(this.currentPage--,this.fetchCustomers())}closeModal(e){this.launchDialogService.closeDialog(e)}getSortLabels(){return(0,R.aj)([this.translation.translate("asm.customerList.tableSort.byNameAsc"),this.translation.translate("asm.customerList.tableSort.byNameDesc"),this.translation.translate("asm.customerList.tableSort.byDateAsc"),this.translation.translate("asm.customerList.tableSort.byDateDesc"),this.translation.translate("asm.customerList.tableSort.byOrderDateAsc"),this.translation.translate("asm.customerList.tableSort.byOrderDateDesc")]).pipe((0,h.U)(([e,o,s,r,a,_])=>({byNameAsc:e,byNameDesc:o,byOrderDateAsc:s,byOrderDateDesc:r,byDateAsc:a,byDateDesc:_})))}getBreakpoint(){return this.breakpointService.breakpoint$.pipe((0,h.U)(e=>((e===l.Bst.lg||e===l.Bst.xl)&&(e=l.Bst.md),e)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.Q3W),t.Y36(l.r),t.Y36(g.hc),t.Y36(c.D7D),t.Y36(g.AH))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-list"]],decls:36,vars:22,consts:[[1,"cx-asm-customer-list","cx-modal-container","cx-asm-dialog",3,"cxFocus","esc"],[1,"cx-modal-content"],[1,"cx-dialog-header","modal-header"],["id","asm-customer-list-title",1,"title","modal-title"],["id","asm-customer-list-desc",1,"cx-visually-hidden"],[4,"ngTemplateOutlet"],["class","cx-dialog-sub-header modal-header",3,"tablet-mobile",4,"ngIf"],[1,"cx-dialog-body","modal-body"],[1,"cx-dialog-row"],[1,"cx-dialog-item"],["class","cx-error-state",4,"ngIf"],[4,"ngIf"],["cell",""],["cellContent",""],["sort",""],["pagination",""],["groupSelector",""],["closeButton",""],[1,"cx-dialog-sub-header","modal-header"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cx-header-actions"],[1,"cx-error-state"],["id","asm-cusomer-list-table","role","table",1,"table"],[1,"cx-visually-hidden"],["role","row",4,"ngFor","ngForOf"],["class","cx-empty-state",4,"ngIf"],["role","row"],["role","columnheader","class","cx-avatar-cell",4,"ngIf"],["role","columnheader",4,"ngFor","ngForOf"],["role","columnheader",1,"cx-avatar-cell"],["role","columnheader"],["role","cell","class","cx-avatar-cell",4,"ngIf"],["role","cell","class","cx-multi-cell",4,"ngIf"],["role","cell",1,"cx-avatar-cell"],[1,"cx-avatar"],["role","cell",4,"ngFor","ngForOf"],["role","cell"],["role","cell",1,"cx-multi-cell"],[4,"ngFor","ngForOf"],[1,"cx-empty-state"],[1,"cx-cell-container"],["class","cx-header-text",4,"ngIf"],["class","btn btn-link cx-action-link cx-btn-cell",3,"click",4,"ngIf"],[1,"cx-header-text"],[1,"btn","btn-link","cx-action-link","cx-btn-cell",3,"click"],[3,"cx-action-color","type",4,"ngIf"],[3,"type"],[1,"sort-selector",3,"sortOptions","sortLabels","selectedOption","placeholder","cxNgSelectA11y","sortListEvent"],[1,"cx-pagination-buttons"],["class","btn btn-link cx-action-link cx-btn-previous",3,"disabled","click",4,"ngIf"],["class","btn btn-link cx-action-link cx-btn-next",3,"disabled","click",4,"ngIf"],[1,"btn","btn-link","cx-action-link","cx-btn-previous",3,"disabled","click"],[1,"previous",3,"type"],[1,"btn","btn-link","cx-action-link","cx-btn-next",3,"disabled","click"],[1,"next",3,"type"],["bindLabel","name","bindValue","uid",1,"customer-list-selector",3,"searchable","clearable","tabIndex","ngModel","items","cxNgSelectA11y","change","ngModelChange"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.NdJ("esc",function(){return o.closeModal("Escape clicked")}),t.TgZ(1,"div",1),t.ynx(2),t.TgZ(3,"div",2)(4,"h2",3),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"cxTranslate"),t.qZA(),t.YNc(10,ve,1,0,null,5),t.qZA(),t.YNc(11,we,7,14,"div",6),t.ALo(12,"async"),t.TgZ(13,"div",7)(14,"div",8)(15,"div",9),t.YNc(16,Ee,3,3,"div",10),t.YNc(17,ke,3,3,"div",10),t.YNc(18,Me,3,3,"div",10),t.ALo(19,"async"),t.YNc(20,Re,1,0,"cx-spinner",11),t.ALo(21,"async"),t.YNc(22,rn,10,8,"div",11),t.ALo(23,"async"),t.qZA()()(),t.BQk(),t.qZA()(),t.YNc(24,dn,4,3,"ng-template",null,12,t.W1O),t.YNc(26,gn,2,2,"ng-template",null,13,t.W1O),t.YNc(28,hn,7,14,"ng-template",null,14,t.W1O),t.YNc(30,An,6,8,"ng-template",null,15,t.W1O),t.YNc(32,vn,5,11,"ng-template",null,16,t.W1O),t.YNc(34,Sn,4,4,"ng-template",null,17,t.W1O)),2&e){const s=t.MAs(35);t.Q6J("cxFocus",o.focusConfig),t.xp6(5),t.hij(" ",t.lcZ(6,10,"asm.customerList.title")," "),t.xp6(3),t.hij(" ",t.lcZ(9,12,"asm.customerList.description")," "),t.xp6(2),t.Q6J("ngTemplateOutlet",s),t.xp6(1),t.Q6J("ngIf",t.lcZ(12,14,o.customerListsPage$)),t.xp6(5),t.Q6J("ngIf",o.listsEmpty),t.xp6(1),t.Q6J("ngIf",o.listsError),t.xp6(1),t.Q6J("ngIf",t.lcZ(19,16,o.customerSearchError$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,18,o.customerSearchLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(23,20,o.customerSearchPage$))}},dependencies:[p.sg,p.O5,p.tP,m.JJ,l.oJW,X.w9,m.On,l.ORR,l.RRe,l.VnX,l.iNG,p.Ov,c.X$D],encapsulation:2}),n})(),dialogType:l.Myk.DIALOG}}},Rn={launch:{ASM:{outlet:"cx-storefront",component:kn}}},Fn={launch:{ASM_BIND_CART:{inlineRoot:!0,component:Tn,dialogType:l.Myk.DIALOG}}};let Un=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,c.i51)(Rn),(0,c.i51)(Fn),(0,c.i51)(Mn)],imports:[p.ez,m.UX,c.LUR,l.Fym,l.QX1,X.A0,m.u5,l.Fme,l.Ird,l.oPH,l.LcC,l.U67]}),n})();var v=u(529),K=u(1737);let Dn=(()=>{class n{constructor(e,o,s,r,a){this.http=e,this.occEndpointsService=o,this.converterService=s,this.config=r,this.baseSiteService=a,this.baseSiteService.getActive().subscribe(_=>this.activeBaseSite=_)}getHeaders(){return c.Fox.createHeader(c.OPk,!0,new v.WM)}customerLists(){const e=this.getHeaders(),o=(new v.LE).set("baseSite",this.activeBaseSite),s=this.occEndpointsService.buildUrl("asmCustomerLists",{},{baseSite:!1,prefix:!1});return this.http.get(s,{headers:e,params:o}).pipe((0,L.K)(r=>(0,K._)((0,c.cxH)(r))),this.converterService.pipeable(Ft))}customerSearch(e){const o=this.getHeaders();let s=(new v.LE).set("baseSite",this.activeBaseSite);void 0!==e.sort?s=s.set("sort",e.sort):e.customerListId||(s=s.set("sort","byNameAsc")),void 0!==e.query&&(s=s.set("query",e.query)),void 0!==e.pageSize&&(s=s.set("pageSize",e.pageSize.toString())),void 0!==e.currentPage&&(s=s.set("currentPage",e.currentPage.toString())),void 0!==e.customerListId&&(s=s.set("customerListId",e.customerListId));const r=this.occEndpointsService.buildUrl("asmCustomerSearch",{},{baseSite:!1,prefix:!1});return this.http.get(r,{headers:o,params:s}).pipe((0,L.K)(a=>(0,K._)((0,c.cxH)(a))),this.converterService.pipeable(Rt))}bindCart({cartId:e,customerId:o}){const s=c.Fox.createHeader(c.OPk,!0,new v.WM),r=(new v.LE).set("baseSite",this.activeBaseSite).set("cartId",e).set("customerId",o),a=this.occEndpointsService.buildUrl("asmBindCart",{},{baseSite:!1,prefix:!1});return this.http.post(a,{},{headers:s,params:r}).pipe((0,L.K)(_=>(0,K._)((0,c.cxH)(_))))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.eN),t.LFG(c.Lz0),t.LFG(c.IXI),t.LFG(g.hc),t.LFG(c.Do$))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const On={backend:{occ:{endpoints:{asmCustomerSearch:"/assistedservicewebservices/customers/search",asmCustomerLists:"/assistedservicewebservices/customerlists",asmBindCart:"/assistedservicewebservices/bind-cart"}}}};let Nn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,c.i51)(On),{provide:$,useClass:Dn}],imports:[p.ez]}),n})(),Jn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Un,zt,Nn]}),n})()}}]);