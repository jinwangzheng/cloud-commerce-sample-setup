"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=162,exports.ids=[162],exports.modules={3162:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PersonalizationModule:()=>PersonalizationModule});var core=__webpack_require__(305),empty=__webpack_require__(4614),filter=__webpack_require__(2026),map=__webpack_require__(6466),spartacus_tracking_personalization_root=__webpack_require__(3143),spartacus_core=__webpack_require__(9345);class PersonalizationCoreModule{}__name(PersonalizationCoreModule,"PersonalizationCoreModule"),PersonalizationCoreModule.\u0275fac=__name(function(t){return new(t||PersonalizationCoreModule)},"PersonalizationCoreModule_Factory"),PersonalizationCoreModule.\u0275mod=core.oAB({type:PersonalizationCoreModule}),PersonalizationCoreModule.\u0275inj=core.cJS({});class PersonalizationContextService{constructor(config,cmsService){this.config=config,this.cmsService=cmsService}getPersonalizationContext(){if(this.config.personalization?.context){const context=this.config.personalization.context;return this.cmsService.getCurrentPage().pipe((0,filter.h)(Boolean),(0,map.U)(page=>page.slots?.[context.slotPosition]),(0,filter.h)(Boolean),(0,map.U)(slot=>{const scriptComponent=slot.components?.find(i=>i.uid===context.componentId);return this.buildPersonalizationContext(scriptComponent?.properties?.script?.data)}))}return(0,core.X6Q)()&&console.warn("There is no context configured in Personalization."),empty.E}buildPersonalizationContext(data){if(data){const context=JSON.parse(atob(data));context.actions.forEach(action=>{Object.keys(action).forEach(key=>{action[key]=atob(action[key])})});for(let i=0;i<context.segments.length;i++)context.segments[i]=atob(context.segments[i]);return context}}}__name(PersonalizationContextService,"PersonalizationContextService"),PersonalizationContextService.\u0275fac=__name(function(t){return new(t||PersonalizationContextService)(core.LFG(spartacus_tracking_personalization_root.TG),core.LFG(spartacus_core.ctt))},"PersonalizationContextService_Factory"),PersonalizationContextService.\u0275prov=core.Yz7({token:PersonalizationContextService,factory:PersonalizationContextService.\u0275fac,providedIn:"root"});class PersonalizationModule{}__name(PersonalizationModule,"PersonalizationModule"),PersonalizationModule.\u0275fac=__name(function(t){return new(t||PersonalizationModule)},"PersonalizationModule_Factory"),PersonalizationModule.\u0275mod=core.oAB({type:PersonalizationModule}),PersonalizationModule.\u0275inj=core.cJS({imports:[PersonalizationCoreModule]})}};