"use strict";(self.webpackChunkb2bspastore=self.webpackChunkb2bspastore||[]).push([[679],{2732:(ut,re,_)=>{_.d(re,{Ru:()=>Q,gV:()=>V,ir:()=>C,t1:()=>yt,u4:()=>X,yN:()=>d});var i=_(4650),R=_(8555),t=_(4947),m=_(2994),p=_(4850),A=_(2986),f=_(7545),y=_(7221),I=_(7168),W=_(2198),P=_(4129),te=_(591),H=_(6053),g=_(1086),se=_(8896),G=_(3749),h=_(5024);class V{}let N=(()=>{class e{constructor(r){this.adapter=r}get(r,o){return this.adapter.load(r,o)}getHistory(r,o,c,u){return this.adapter.loadHistory(r,o,c,u)}getConsignmentTracking(r,o,c){return this.adapter.getConsignmentTracking(r,o,c)}cancel(r,o,c){return this.adapter.cancel(r,o,c)}return(r,o){return this.adapter.createReturnRequest(r,o)}getReturnRequestDetail(r,o){return this.adapter.loadReturnRequestDetail(r,o)}getReturnRequestList(r,o,c,u){return this.adapter.loadReturnRequestList(r,o,c,u)}cancelReturnRequest(r,o,c){return this.adapter.cancelReturnRequest(r,o,c)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(V))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class Q{}let j=(()=>{class e{constructor(r){this.adapter=r}placeOrder(r,o,c){return this.adapter.placeOrder(r,o,c)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(Q))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class X{}let a=(()=>{class e{constructor(r){this.adapter=r}reorder(r,o){return this.adapter.reorder(r,o)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(X))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class C{}let n=(()=>{class e{constructor(r){this.adapter=r}load(r,o){return this.adapter.load(r,o)}loadReplenishmentDetailsHistory(r,o,c,u,S){return this.adapter.loadReplenishmentDetailsHistory(r,o,c,u,S)}cancelReplenishmentOrder(r,o){return this.adapter.cancelReplenishmentOrder(r,o)}loadHistory(r,o,c,u){return this.adapter.loadHistory(r,o,c,u)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(C))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class d{}let l=(()=>{class e{constructor(r){this.adapter=r}scheduleReplenishmentOrder(r,o,c,u){return this.adapter.scheduleReplenishmentOrder(r,o,c,u)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(d))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();const O="[Order] Load Consignment Tracking",D="[Order] Load Consignment Tracking Success",ne="[Order] Clear Consignment Tracking";class Ue{constructor(s){this.payload=s,this.type=O}}class Te{constructor(s){this.payload=s,this.type="[Order] Load Consignment Tracking Fail"}}class Fe{constructor(s){this.payload=s,this.type=D}}class Ie{constructor(){this.type=ne}}const k="cancelOrder",w="cancelReturn",M="cancelReplenishmentOrder",q="[Order] User Orders",z="[Order] Order Return Requests",T="[Order] Return Request Details",$="[Order] User Order Details",b="[Order] User Replenishment Orders",Y="[Order] User Replenishment Order Details",oe="[Order] Load Order Details",ie="[Order] Load Order Details Success",ce="[Order] Cancel Order";class He extends t.kPG.LoaderLoadAction{constructor(s){super($),this.payload=s,this.type=oe}}class de extends t.kPG.LoaderFailAction{constructor(s){super($,s),this.payload=s,this.type="[Order] Load Order Details Fail"}}class ae extends t.kPG.LoaderSuccessAction{constructor(s){super($),this.payload=s,this.type=ie}}class qe extends t.kPG.LoaderResetAction{constructor(){super($),this.type="[Order] Clear Order Details"}}class ze extends t.kPG.EntityLoadAction{constructor(s){super(t.BzF,k),this.payload=s,this.type=ce}}class $e extends t.kPG.EntityFailAction{constructor(s){super(t.BzF,k,s),this.payload=s,this.type="[Order] Cancel Order Fail"}}class be extends t.kPG.EntitySuccessAction{constructor(){super(t.BzF,k),this.type="[Order] Cancel Order Success"}}class Ye extends t.kPG.EntityLoaderResetAction{constructor(){super(t.BzF,k),this.type="[Order] Reset Cancel Order Process"}}const ue="[Order] Create Order Return Request",le="[Order] Load Order Return Request details",Re="[Order] Cancel Order Return Request",pe="[Order] Load User Order Return Request List",Oe="[Order] Load User Order Return Request List Success";class rr extends t.kPG.LoaderLoadAction{constructor(s){super(T),this.payload=s,this.type=ue}}class tr extends t.kPG.LoaderFailAction{constructor(s){super(T,s),this.payload=s,this.type="[Order] Create Order Return Request Fail"}}class sr extends t.kPG.LoaderSuccessAction{constructor(s){super(T),this.payload=s,this.type="[Order] Create Order Return Request Success"}}class nr extends t.kPG.LoaderLoadAction{constructor(s){super(T),this.payload=s,this.type=le}}class or extends t.kPG.LoaderFailAction{constructor(s){super(T,s),this.payload=s,this.type="[Order] Load Order Return Request details Fail"}}class ir extends t.kPG.LoaderSuccessAction{constructor(s){super(T),this.payload=s,this.type="[Order] Load Order Return Request details Success"}}class cr extends t.kPG.EntityLoadAction{constructor(s){super(t.BzF,w),this.payload=s,this.type=Re}}class dr extends t.kPG.EntityFailAction{constructor(s){super(t.BzF,w,s),this.payload=s,this.type="[Order] Cancel Order Return Request Fail"}}class ar extends t.kPG.EntitySuccessAction{constructor(){super(t.BzF,w),this.type="[Order] Cancel Order Return Request Success"}}class ur extends t.kPG.LoaderLoadAction{constructor(s){super(z),this.payload=s,this.type=pe}}class lr extends t.kPG.LoaderFailAction{constructor(s){super(z,s),this.payload=s,this.type="[Order] Load User Order Return Request List Fail"}}class Rr extends t.kPG.LoaderSuccessAction{constructor(s){super(z),this.payload=s,this.type=Oe}}class pr extends t.kPG.LoaderResetAction{constructor(){super(T),this.type="[Order] Clear Order Return Request Details"}}class Or extends t.kPG.LoaderResetAction{constructor(){super(z),this.type="[Order] Clear Order Return Request List"}}class hr extends t.kPG.EntityLoaderResetAction{constructor(){super(t.BzF,w),this.type="[Order] Reset Cancel Return Request Process"}}const he="[Order] Load User Orders",Ee="[Order] Load User Orders Fail",_e="[Order] Load User Orders Success";class _r extends t.kPG.LoaderLoadAction{constructor(s){super(q),this.payload=s,this.type=he}}class Lr extends t.kPG.LoaderFailAction{constructor(s){super(q,s),this.payload=s,this.type=Ee}}class Sr extends t.kPG.LoaderSuccessAction{constructor(s){super(q),this.payload=s,this.type=_e}}class Le extends t.kPG.LoaderResetAction{constructor(){super(q),this.type="[Order] Clear User Orders"}}const Se="[Order] Load Replenishment Order Details",Ce="[Order] Load Replenishment Order Details Success",fe="[Order] Cancel Replenishment Order",J="[Order] Cancel Replenishment Order Success";class gr extends t.kPG.LoaderLoadAction{constructor(s){super(Y),this.payload=s,this.type=Se}}class vr extends t.kPG.LoaderSuccessAction{constructor(s){super(Y),this.payload=s,this.type=Ce}}class yr extends t.kPG.LoaderFailAction{constructor(s){super(Y,s),this.payload=s,this.type="[Order] Load Replenishment Order Details Fail"}}class Ar extends t.kPG.LoaderResetAction{constructor(){super(Y),this.type="[Order] Clear Replenishment Order Details"}}class Pr extends t.kPG.EntityLoadAction{constructor(s){super(t.BzF,M),this.payload=s,this.type=fe}}class Ur extends t.kPG.EntitySuccessAction{constructor(s){super(t.BzF,M),this.payload=s,this.type=J}}class Tr extends t.kPG.EntityFailAction{constructor(s){super(t.BzF,M,s),this.payload=s,this.type="[Order] Cancel Replenishment Order Fail"}}class Fr extends t.kPG.EntityLoaderResetAction{constructor(){super(t.BzF,M),this.type="[Order] Clear Cancel Replenishment Order"}}const De="[Order] Load User Replenishment Orders",me="[Order] Load User Replenishment Orders Success";class Mr extends t.kPG.LoaderLoadAction{constructor(s){super(b),this.payload=s,this.type=De}}class Gr extends t.kPG.LoaderFailAction{constructor(s){super(b,s),this.payload=s,this.type="[Order] Load User Replenishment Orders Fail"}}class kr extends t.kPG.LoaderSuccessAction{constructor(s){super(b),this.payload=s,this.type=me}}class wr extends t.kPG.LoaderResetAction{constructor(){super(b),this.type="[Order] Clear User Replenishment Orders"}}const F=(0,R.ZF)("order"),xr=(0,R.P1)(F,e=>e.consignmentTracking),Hr=(0,R.P1)(xr,e=>e.tracking),ge=(0,R.P1)(F,e=>e.orderDetail),qr=(0,R.P1)(ge,e=>t.kPG.loaderValueSelector(e)),zr=(0,R.P1)(ge,e=>t.kPG.loaderLoadingSelector(e)),Z=(0,R.P1)(F,e=>e.orderReturn),$r=(0,R.P1)(Z,e=>t.kPG.loaderValueSelector(e)),br=(0,R.P1)(Z,e=>t.kPG.loaderLoadingSelector(e)),Yr=(0,R.P1)(Z,e=>t.kPG.loaderSuccessSelector(e)&&!t.kPG.loaderLoadingSelector(e)),ve=(0,R.P1)(F,e=>e.orderReturnList),ee=((0,R.P1)(ve,e=>t.kPG.loaderValueSelector(e)),(0,R.P1)(F,e=>e.orders)),Br=(0,R.P1)(ee,e=>t.kPG.loaderSuccessSelector(e)),B=((0,R.P1)(ee,e=>t.kPG.loaderValueSelector(e)),(0,R.P1)(F,e=>e.replenishmentOrder)),Kr=(0,R.P1)(B,e=>t.kPG.loaderValueSelector(e)),Wr=(0,R.P1)(B,e=>t.kPG.loaderLoadingSelector(e)),Vr=(0,R.P1)(B,e=>t.kPG.loaderSuccessSelector(e)),Qr=(0,R.P1)(B,e=>t.kPG.loaderErrorSelector(e)),x=(0,R.P1)(F,e=>e.replenishmentOrders),jr=((0,R.P1)(x,e=>t.kPG.loaderValueSelector(e)),(0,R.P1)(x,e=>t.kPG.loaderLoadingSelector(e))),Xr=(0,R.P1)(x,e=>t.kPG.loaderErrorSelector(e)),Jr=(0,R.P1)(x,e=>t.kPG.loaderSuccessSelector(e));let Zr=(()=>{class e{constructor(r,o,c,u){this.store=r,this.processStateStore=o,this.userIdService=c,this.routingService=u}getOrderDetails(){return this.store.pipe((0,R.Ys)(qr))}loadOrderDetails(r){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new He({userId:o,orderCode:r}))})}clearOrderDetails(){this.store.dispatch(new qe)}getOrderHistoryList(r){return this.store.pipe((0,R.Ys)(ee),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadOrderList(r)}),(0,p.U)(o=>o.value))}getOrderHistoryListLoaded(){return this.store.pipe((0,R.Ys)(Br))}loadOrderList(r,o,c){this.userIdService.takeUserId(!0).subscribe(u=>{let S;this.routingService.getRouterState().pipe((0,A.q)(1)).subscribe(L=>{S=L?.state?.params?.replenishmentOrderCode}).unsubscribe(),this.store.dispatch(new _r({userId:u,pageSize:r,currentPage:o,sort:c,replenishmentOrderCode:S}))},()=>{})}clearOrderList(){this.store.dispatch(new Le)}getConsignmentTracking(){return this.store.pipe((0,R.Ys)(Hr))}loadConsignmentTracking(r,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new Ue({userId:c,orderCode:r,consignmentCode:o}))})}clearConsignmentTracking(){this.store.dispatch(new Ie)}cancelOrder(r,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new ze({userId:c,orderCode:r,cancelRequestInput:o}))})}getCancelOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessLoadingFactory(k)))}getCancelOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessSuccessFactory(k)))}resetCancelOrderProcessState(){return this.store.dispatch(new Ye)}getOrderDetailsLoading(){return this.store.pipe((0,R.Ys)(zr))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(t.XBV),i.LFG(t.Znh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),et=(()=>{class e{constructor(r,o,c){this.store=r,this.processStateStore=o,this.userIdService=c}createOrderReturnRequest(r){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new rr({userId:o,returnRequestInput:r}))})}getOrderReturnRequest(){return this.store.pipe((0,R.Ys)($r))}getOrderReturnRequestList(r){return this.store.pipe((0,R.Ys)(ve),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadOrderReturnRequestList(r)}),(0,p.U)(o=>o.value))}loadOrderReturnRequestDetail(r){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new nr({userId:o,returnRequestCode:r}))})}loadOrderReturnRequestList(r,o,c){this.userIdService.takeUserId(!0).subscribe(u=>{this.store.dispatch(new ur({userId:u,pageSize:r,currentPage:o,sort:c}))},()=>{})}clearOrderReturnRequestList(){this.store.dispatch(new Or)}getReturnRequestLoading(){return this.store.pipe((0,R.Ys)(br))}getReturnRequestSuccess(){return this.store.pipe((0,R.Ys)(Yr))}clearOrderReturnRequestDetail(){this.store.dispatch(new pr)}cancelOrderReturnRequest(r,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new cr({userId:c,returnRequestCode:r,returnRequestModification:o}))})}getCancelReturnRequestLoading(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessLoadingFactory(w)))}getCancelReturnRequestSuccess(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessSuccessFactory(w)))}resetCancelReturnRequestProcessState(){return this.store.dispatch(new hr)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(t.XBV))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),rt=(()=>{class e{constructor(r,o,c,u,S){this.activeCartFacade=r,this.userIdService=o,this.commandService=c,this.orderConnector=u,this.eventService=S,this.placedOrder$=new te.X(void 0),this.placeOrderCommand=this.commandService.create(L=>this.checkoutPreconditions().pipe((0,f.w)(([v,U])=>this.orderConnector.placeOrder(v,U,L).pipe((0,m.b)(K=>{this.placedOrder$.next(K),this.eventService.dispatch({userId:v,cartId:U,cartCode:U,order:K},P.uZ)})))),{strategy:t.flE.CancelPrevious})}checkoutPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,A.q)(1),(0,p.U)(([r,o,c])=>{if(!r||!o||r===t.Fds&&!c)throw new Error("Checkout conditions not met");return[r,o]}))}placeOrder(r){return this.placeOrderCommand.execute(r)}getOrderDetails(){return this.placedOrder$.asObservable()}clearPlacedOrder(){this.placedOrder$.next(void 0)}setPlacedOrder(r){this.placedOrder$.next(r)}getPickupEntries(){return this.getOrderDetails().pipe((0,p.U)(r=>r?.entries?.filter(o=>void 0!==o.deliveryPointOfService)||[]))}getDeliveryEntries(){return this.getOrderDetails().pipe((0,p.U)(r=>r?.entries?.filter(o=>void 0===o.deliveryPointOfService)||[]))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(G.bu),i.LFG(t.XBV),i.LFG(t.VDr),i.LFG(j),i.LFG(t.POd))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),tt=(()=>{class e{constructor(r,o,c,u,S){this.commandService=r,this.reorderOrderConnector=o,this.userIdService=c,this.activeCartFacade=u,this.multiCartFacade=S,this.reorderCommand=this.commandService.create(({orderId:L})=>this.reorderPreconditions().pipe((0,f.w)(v=>this.reorderOrderConnector.reorder(L,v))),{strategy:t.flE.CancelPrevious})}reorder(r){return this.reorderCommand.execute({orderId:r})}reorderPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.getActiveCartId()]).pipe((0,A.q)(1),(0,p.U)(([r,o])=>{if(!r)throw new Error("Must be logged in to reorder");return o&&this.multiCartFacade.deleteCart(o,r),r}))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(t.VDr),i.LFG(a),i.LFG(t.XBV),i.LFG(G.bu),i.LFG(G.WT))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),st=(()=>{class e{constructor(r,o,c){this.store=r,this.processStateStore=o,this.userIdService=c}loadReplenishmentOrderDetails(r){this.userIdService.takeUserId(!0).subscribe(o=>{this.store.dispatch(new gr({userId:o,replenishmentOrderCode:r}))},()=>{})}getReplenishmentOrderDetails(){return this.store.pipe((0,R.Ys)(Kr))}getReplenishmentOrderDetailsLoading(){return this.store.pipe((0,R.Ys)(Wr))}getReplenishmentOrderDetailsSuccess(){return this.store.pipe((0,R.Ys)(Vr))}getReplenishmentOrderDetailsError(){return this.store.pipe((0,R.Ys)(Qr))}clearReplenishmentOrderDetails(){this.store.dispatch(new Ar)}cancelReplenishmentOrder(r){this.userIdService.takeUserId(!0).subscribe(o=>{this.store.dispatch(new Pr({userId:o,replenishmentOrderCode:r}))},()=>{})}getCancelReplenishmentOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessLoadingFactory(M)))}getCancelReplenishmentOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessSuccessFactory(M)))}getCancelReplenishmentOrderError(){return this.processStateStore.pipe((0,R.Ys)(t.VkE.getProcessErrorFactory(M)))}clearCancelReplenishmentOrderProcessState(){this.store.dispatch(new Fr)}getReplenishmentOrderHistoryList(r){return this.store.pipe((0,R.Ys)(x),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadReplenishmentOrderList(r)}),(0,p.U)(o=>o.value))}getReplenishmentOrderHistoryListLoading(){return this.store.pipe((0,R.Ys)(jr))}getReplenishmentOrderHistoryListError(){return this.store.pipe((0,R.Ys)(Xr))}getReplenishmentOrderHistoryListSuccess(){return this.store.pipe((0,R.Ys)(Jr))}loadReplenishmentOrderList(r,o,c){this.userIdService.takeUserId(!0).subscribe(u=>{this.store.dispatch(new Mr({userId:u,pageSize:r,currentPage:o,sort:c}))},()=>{})}clearReplenishmentOrderList(){this.store.dispatch(new wr)}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(t.XBV))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),nt=(()=>{class e{constructor(r,o,c,u,S,L){this.activeCartFacade=r,this.userIdService=o,this.commandService=c,this.scheduledReplenishmentOrderConnector=u,this.eventService=S,this.orderFacade=L,this.scheduleReplenishmentOrderCommand=this.commandService.create(({form:v,termsChecked:U})=>this.checkoutPreconditions().pipe((0,f.w)(([K,Pe])=>this.scheduledReplenishmentOrderConnector.scheduleReplenishmentOrder(Pe,v,U,K).pipe((0,m.b)(at=>{this.orderFacade.setPlacedOrder(at),this.eventService.dispatch({userId:K,cartId:Pe,cartCode:Pe,replenishmentOrder:at},P.oL)})))),{strategy:t.flE.CancelPrevious})}checkoutPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,A.q)(1),(0,p.U)(([r,o,c])=>{if(!r||!o||r===t.Fds&&!c)throw new Error("Order conditions not met");return[r,o]}))}scheduleReplenishmentOrder(r,o){return this.scheduleReplenishmentOrderCommand.execute({termsChecked:o,form:r})}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(G.bu),i.LFG(t.XBV),i.LFG(t.VDr),i.LFG(l),i.LFG(t.POd),i.LFG(P.Vh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();const Ot=[et,{provide:P.U1,useExisting:et},Zr,{provide:P.Kr,useExisting:Zr},st,{provide:P.kp,useExisting:st},nt,{provide:P.wT,useExisting:nt},rt,{provide:P.Vh,useExisting:rt},tt,{provide:P.t7,useExisting:tt}],ht=[(()=>{class e{constructor(r,o,c){this.actions$=r,this.orderConnector=o,this.replenishmentOrderConnector=c,this.loadUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(he),(0,p.U)(u=>u.payload),(0,f.w)(u=>(Boolean(u.replenishmentOrderCode)?this.replenishmentOrderConnector.loadReplenishmentDetailsHistory(u.userId,u.replenishmentOrderCode??"",u.pageSize,u.currentPage,u.sort):this.orderConnector.getHistory(u.userId,u.pageSize,u.currentPage,u.sort)).pipe((0,p.U)(S=>new Sr(S)),(0,y.K)(S=>(0,g.of)(new Lr((0,t.cxH)(S)))))))),this.resetUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(t.dO9.LANGUAGE_CHANGE),(0,p.U)(()=>new Le)))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(N),i.LFG(n))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(r,o,c,u,S){this.actions$=r,this.orderConnector=o,this.globalMessageService=c,this.userIdService=u,this.store=S,this.loadOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(oe),(0,p.U)(L=>L.payload),(0,f.w)(L=>this.orderConnector.get(L.userId,L.orderCode).pipe((0,p.U)(v=>new ae(v)),(0,y.K)(v=>(0,g.of)(new de((0,t.cxH)(v)))))))),this.cancelOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ce),(0,p.U)(L=>L.payload),(0,f.w)(L=>this.orderConnector.cancel(L.userId,L.orderCode,L.cancelRequestInput).pipe((0,p.U)(()=>new be),(0,y.K)(v=>(v.error?.errors.forEach(U=>this.globalMessageService.add(U.message,t.xUg.MSG_TYPE_ERROR)),(0,g.of)(new $e((0,t.cxH)(v))))))))),this.resetOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(t.dO9.LANGUAGE_CHANGE,t.dO9.CURRENCY_CHANGE),(0,I.M)(this.userIdService.getUserId(),this.store.pipe((0,W.h)(L=>!!L.order?.orderDetail),(0,p.U)(L=>L.order.orderDetail.value?.code))),(0,f.w)(([,L,v])=>v?this.orderConnector.get(L,v).pipe((0,p.U)(U=>new ae(U)),(0,y.K)(U=>(0,g.of)(new de((0,t.cxH)(U))))):se.E)))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(N),i.LFG(t.IWp),i.LFG(t.XBV),i.LFG(R.yh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(r,o){this.actions$=r,this.orderConnector=o,this.loadConsignmentTracking$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(O),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.orderConnector.getConsignmentTracking(c.orderCode,c.consignmentCode,c.userId).pipe((0,p.U)(u=>new Fe(u)),(0,y.K)(u=>(0,g.of)(new Te((0,t.cxH)(u))))))))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(N))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(r,o){this.actions$=r,this.orderConnector=o,this.createReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ue),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.orderConnector.return(c.userId,c.returnRequestInput).pipe((0,p.U)(u=>new sr(u)),(0,y.K)(u=>(0,g.of)(new tr((0,t.cxH)(u)))))))),this.loadReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(le),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.orderConnector.getReturnRequestDetail(c.userId,c.returnRequestCode).pipe((0,p.U)(u=>new ir(u)),(0,y.K)(u=>(0,g.of)(new or((0,t.cxH)(u)))))))),this.cancelReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(Re),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.orderConnector.cancelReturnRequest(c.userId,c.returnRequestCode,c.returnRequestModification).pipe((0,p.U)(()=>new ar),(0,y.K)(u=>(0,g.of)(new dr((0,t.cxH)(u)))))))),this.loadReturnRequestList$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(pe),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.orderConnector.getReturnRequestList(c.userId,c.pageSize,c.currentPage,c.sort).pipe((0,p.U)(u=>new Rr(u)),(0,y.K)(u=>(0,g.of)(new lr((0,t.cxH)(u))))))))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(N))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(r,o,c){this.actions$=r,this.replenishmentOrderConnector=o,this.globalMessageService=c,this.loadReplenishmentOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(Se),(0,p.U)(u=>u.payload),(0,f.w)(u=>this.replenishmentOrderConnector.load(u.userId,u.replenishmentOrderCode).pipe((0,p.U)(S=>new vr(S)),(0,y.K)(S=>(0,g.of)(new yr((0,t.cxH)(S)))))))),this.cancelReplenishmentOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(fe),(0,p.U)(u=>u.payload),(0,f.w)(u=>this.replenishmentOrderConnector.cancelReplenishmentOrder(u.userId,u.replenishmentOrderCode).pipe((0,p.U)(S=>new Ur(S)),(0,y.K)(S=>(S?.error?.errors.forEach(L=>this.globalMessageService.add(L.message,t.xUg.MSG_TYPE_ERROR)),(0,g.of)(new Tr((0,t.cxH)(S)))))))))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(n),i.LFG(t.IWp))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(r,o){this.actions$=r,this.replenishmentOrderConnector=o,this.loadUserReplenishmentOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(De),(0,p.U)(c=>c.payload),(0,f.w)(c=>this.replenishmentOrderConnector.loadHistory(c.userId,c.pageSize,c.currentPage,c.sort).pipe((0,p.U)(u=>new kr(u)),(0,y.K)(u=>(0,g.of)(new Gr((0,t.cxH)(u))))))))}}return e.\u0275fac=function(r){return new(r||e)(i.LFG(h.eX),i.LFG(n))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})()],ot={tracking:{}};function Et(e=ot,s){switch(s.type){case D:return{tracking:s.payload};case ne:return ot}return e}const _t={};function Lt(e=_t,s){return s.type===ie?s.payload:e}const it={returnRequests:[],pagination:{},sorts:[]};function St(e=it,s){return s.type===Oe?s.payload?s.payload:it:e}const ye={orders:[],pagination:{},sorts:[]};function Ct(e=ye,s){switch(s.type){case _e:return s.payload?s.payload:ye;case Ee:return ye}return e}const ct={};function ft(e=ct,s){switch(s.type){case Ce:case J:return s.payload?s.payload:ct;default:return e}}const Ae={replenishmentOrders:[],pagination:{},sorts:[]};function Dt(e=Ae,s){switch(s.type){case me:return s.payload?s.payload:Ae;case J:{const r=s.payload,o=[...e.replenishmentOrders??[]],c=o.findIndex(u=>u.replenishmentOrderCode===r.replenishmentOrderCode);return-1===c?Ae:(o[c]={...r},{...e,replenishmentOrders:o})}}return e}const dt=new i.OlP("OrderReducers"),gt={provide:dt,useFactory:function mt(){return{orders:t.kPG.loaderReducer(q,Ct),orderDetail:t.kPG.loaderReducer($,Lt),replenishmentOrders:t.kPG.loaderReducer(b,Dt),orderReturn:t.kPG.loaderReducer(T),orderReturnList:t.kPG.loaderReducer(z,St),consignmentTracking:Et,replenishmentOrder:t.kPG.loaderReducer(Y,ft)}}};let vt=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[gt],imports:[h.sQ.forFeature(ht),R.Aw.forFeature("order",dt)]}),e})(),yt=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[...Ot,N,n,j,l,a],imports:[vt]}),e})()},679:(ut,re,_)=>{_.d(re,{FV:()=>X,mb:()=>W});var i=_(4650),R=_(3749),t=_(4947),m=_(529),p=_(4129),A=_(1737),f=_(7221),y=_(6895),I=_(2732);let W=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.entries&&(d.entries=n.entries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),n.consignments&&(d.consignments=n.consignments.map(l=>({...l,entries:l.entries?.map(O=>({...O,orderEntry:this.convertOrderEntry(O.orderEntry,n.code,n.appliedProductPromotions)}))}))),n.unconsignedEntries&&(d.unconsignedEntries=n.unconsignedEntries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),d}convertOrderEntry(n,d,l){return{...n,product:this.converter.convert(n?.product,t.jrf),orderCode:d,promotions:this.converter.convert({item:n,promotions:l},R.Cx)}}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),P=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.entries&&(d.entries=n.entries.map(l=>({...l,product:this.converter.convert(l.product,t.jrf),promotions:this.converter.convert({item:l,promotions:n.appliedProductPromotions},R.Cx)}))),d}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),te=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.returnEntries&&(d.returnEntries=n.returnEntries.map(l=>({...l,orderEntry:this.convertOrderEntry(l.orderEntry)}))),d}convertOrderEntry(n){return{...n,product:this.converter.convert(n?.product,t.jrf)}}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),H=(()=>{class a{convert(n,d){return void 0===d&&(d={...n}),n.replenishmentStartDate&&(d.replenishmentStartDate=this.convertDate(n.replenishmentStartDate)),d}convertDate(n){return`${n}T${(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hourCycle:"h23"})}:00${t.IMh.getLocalTimezoneOffset()}`}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const g={"Content-Type":"application/json"};let se=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}load(n,d){const l=this.occEndpoints.buildUrl("orderDetail",{urlParams:{userId:n,orderId:d}});let O=new m.WM;return n===t.Fds&&(O=t.Fox.createHeader(t._Re,!0,O)),this.http.get(l,{headers:O}).pipe(this.converter.pipeable(p.YA))}loadHistory(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("orderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.Rc))}getConsignmentTracking(n,d,l=t.zyp){const O=this.occEndpoints.buildUrl("consignmentTracking",{urlParams:{userId:l,orderCode:n,consignmentCode:d}});return this.http.get(O).pipe(this.converter.pipeable(p.m1))}cancel(n,d,l){const O=this.occEndpoints.buildUrl("cancelOrder",{urlParams:{userId:n,orderId:d}}),E=new m.WM({...g});return this.http.post(O,l,{headers:E}).pipe((0,f.K)(D=>(0,A._)(D)))}createReturnRequest(n,d){const l=this.occEndpoints.buildUrl("returnOrder",{urlParams:{userId:n}}),O=new m.WM({...g});return d=this.converter.convert(d,p.Nz),this.http.post(l,d,{headers:O}).pipe((0,f.K)(E=>(0,A._)(E)),this.converter.pipeable(p.Ge))}loadReturnRequestList(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("orderReturns",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.SL))}loadReturnRequestDetail(n,d){const l=this.occEndpoints.buildUrl("orderReturnDetail",{urlParams:{userId:n,returnRequestCode:d}});return this.http.get(l).pipe(this.converter.pipeable(p.Ge))}cancelReturnRequest(n,d,l){const O=this.occEndpoints.buildUrl("cancelReturn",{urlParams:{userId:n,returnRequestCode:d}}),E=new m.WM({...g});return this.http.patch(O,l,{headers:E}).pipe((0,f.K)(D=>(0,A._)(D)))}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(m.eN),i.LFG(t.Lz0),i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),G=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}placeOrder(n,d,l){let O=new m.WM({"Content-Type":"application/x-www-form-urlencoded"});return n===t.Fds&&(O=t.Fox.createHeader(t._Re,!0,O)),this.http.post(this.getPlaceOrderEndpoint(n,d,l.toString()),{},{headers:O}).pipe((0,f.K)(E=>(0,A._)((0,t.cxH)(E))),(0,t.twT)({shouldRetry:t.Pzz}),this.converter.pipeable(p.YA))}getPlaceOrderEndpoint(n,d,l){return this.occEndpoints.buildUrl("placeOrder",{urlParams:{userId:n},queryParams:{cartId:d,termsChecked:l}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(m.eN),i.LFG(t.Lz0),i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),h=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}load(n,d){return this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetails",{urlParams:{userId:n,replenishmentOrderCode:d}})).pipe(this.converter.pipeable(p.JD))}loadReplenishmentDetailsHistory(n,d,l,O,E){const D={};return l&&(D.pageSize=l.toString()),O&&(D.currentPage=O.toString()),E&&(D.sort=E.toString()),this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetailsHistory",{urlParams:{userId:n,replenishmentOrderCode:d},queryParams:D})).pipe(this.converter.pipeable(p.Rc))}cancelReplenishmentOrder(n,d){const l=(new m.WM).set("Content-Type","application/json");return this.http.patch(this.occEndpoints.buildUrl("cancelReplenishmentOrder",{urlParams:{userId:n,replenishmentOrderCode:d}}),{},{headers:l}).pipe(this.converter.pipeable(p.JD))}loadHistory(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("replenishmentOrderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.HN))}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(m.eN),i.LFG(t.Lz0),i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),V=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}scheduleReplenishmentOrder(n,d,l,O){d=this.converter.convert(d,p.dC);const E=(new m.WM).set("Content-Type","application/json");return this.http.post(this.getScheduleReplenishmentOrderEndpoint(O,n,l.toString()),d,{headers:E}).pipe((0,f.K)(D=>(0,A._)((0,t.cxH)(D))),(0,t.twT)({shouldRetry:t.Pzz}),this.converter.pipeable(p.JD))}getScheduleReplenishmentOrderEndpoint(n,d,l){return this.occEndpoints.buildUrl("scheduleReplenishmentOrder",{urlParams:{userId:n},queryParams:{cartId:d,termsChecked:l}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(m.eN),i.LFG(t.Lz0),i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),N=(()=>{class a{convert(n,d){return void 0===d&&(d={...n}),d}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),Q=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}reorder(n,d){const l=(new m.WM).set("Content-Type","application/json");return this.http.post(this.getReorderOrderEndpoint(n,d),{},{headers:l}).pipe((0,f.K)(O=>(0,A._)((0,t.cxH)(O))),this.converter.pipeable(p.W4))}getReorderOrderEndpoint(n,d){return this.occEndpoints.buildUrl("reorder",{urlParams:{userId:d},queryParams:{orderCode:n}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(m.eN),i.LFG(t.Lz0),i.LFG(t.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})();const j={backend:{occ:{endpoints:{orderHistory:"users/${userId}/orders",orderDetail:"users/${userId}/orders/${orderId}?fields=FULL",consignmentTracking:"users/${userId}/orders/${orderCode}/consignments/${consignmentCode}/tracking",cancelOrder:"users/${userId}/orders/${orderId}/cancellation",returnOrder:"users/${userId}/orderReturns?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",orderReturns:"users/${userId}/orderReturns?fields=BASIC",orderReturnDetail:"users/${userId}/orderReturns/${returnRequestCode}?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",cancelReturn:"users/${userId}/orderReturns/${returnRequestCode}",replenishmentOrderDetails:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderDetailsHistory:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}/orders",cancelReplenishmentOrder:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderHistory:"users/${userId}/replenishmentOrders?fields=FULL,replenishmentOrders(FULL, purchaseOrderNumber)",placeOrder:"users/${userId}/orders?fields=FULL"}}}};let X=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=i.oAB({type:a}),a.\u0275inj=i.cJS({providers:[(0,t.i51)(j),{provide:I.gV,useClass:se},{provide:I.ir,useClass:h},{provide:I.Ru,useClass:G},{provide:I.yN,useClass:V},{provide:I.u4,useClass:Q},{provide:p.Ge,useExisting:te,multi:!0},{provide:p.YA,useExisting:W,multi:!0},{provide:p.JD,useExisting:P,multi:!0},{provide:p.dC,useExisting:H,multi:!0},{provide:p.W4,useExisting:N,multi:!0}],imports:[y.ez]}),a})()}}]);